(self.webpackChunkocap=self.webpackChunkocap||[]).push([[1443],{"./packages/angular/controls/member-list/member-list.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n}\n\n.mat-progress-spinner {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  margin-left: -20px;\n  margin-top: -20px;\n}\n\n.ngm-member-list__members {\n  overflow-y: auto;\n  height: 100%;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/controls/member-table/member-table.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n}\n\n.cdk-virtual-scroll-viewport.cdk-virtual-scroll-orientation-vertical {\n  flex: 1;\n}\n.cdk-virtual-scroll-viewport.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper {\n  height: 100%;\n}\n\n.mat-mdc-table {\n  width: 100%;\n  height: 100%;\n  table-layout: fixed;\n  background: unset;\n}\n\n.mat-cell {\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n}\n\n.mat-column-select {\n  width: 60px;\n}\n\n.ngm-member-table__search {\n  width: 100%;\n}\n\n.mat-progress-spinner {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  margin-left: -25px;\n  margin-top: -25px;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/controls/member-tree/member-tree.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n}\n\n.tree-node {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n.tree-node .mat-checkbox {\n  padding-right: 1rem;\n}\n\n.mat-progress-spinner {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  margin-left: -25px;\n  margin-top: -25px;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/controls/smart-filter/smart-filter.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n\n    display: flex;\n\n    flex-direction: column;\n\n    align-items: stretch;\n\n    justify-content: flex-start\n}\n\n.ngm-smart-filter__suffix {\n\n    position: absolute;\n\n    right: 0px\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/controls/smart-select/smart-select.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  justify-content: flex-end;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/controls/tree-select/tree-select.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  justify-content: flex-end;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/controls/value-help/value-help.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  max-width: 100%;\n}\n\n.mat-divider.mat-divider-vertical {\n  margin: 0 10px;\n}\n\n.ngm-value-help__available .sub-title {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.ngm-value-help__available-members {\n  display: flex;\n  flex-direction: column;\n  width: 500px;\n  flex: 1;\n}\n.ngm-value-help__available-members .ngm-value-help__members {\n  flex: 1;\n  min-height: 300px;\n}\n\n.ngm-value-help__options {\n  overflow: hidden;\n  transition-duration: 300ms;\n}\n\n.ngm-value-help__selected {\n  display: flex;\n  flex-direction: column;\n  max-width: 300px;\n  overflow: hidden;\n}\n\n.ngm-value-help__selected-members {\n  flex: 1;\n  min-height: 200px;\n  min-width: 20rem;\n  max-width: 100%;\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 10px;\n}\n.ngm-value-help__selected-members .ngm-value-help__selected-members-list {\n  flex: 1;\n  max-height: 300px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n.ngm-value-help__selected-members .ngm-value-help__selected-members-list .mdc-list-item.mdc-list-item--with-one-line {\n  --mdc-list-list-item-container-shape: 5px;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/controls/controls.module.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$:()=>NgmControlsModule});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_member_list_member_list_component__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/angular/controls/member-list/member-list.component.ts"),_member_table_member_table_component__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/angular/controls/member-table/member-table.component.ts"),_member_tree_member_tree_component__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/angular/controls/member-tree/member-tree.component.ts"),_smart_filter_smart_filter_component__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/angular/controls/smart-filter/smart-filter.component.ts"),_smart_select_smart_select_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/angular/controls/smart-select/smart-select.component.ts"),_tree_select_tree_select_component__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./packages/angular/controls/tree-select/tree-select.component.ts"),_value_help_value_help_component__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./packages/angular/controls/value-help/value-help.component.ts");let NgmControlsModule=class NgmControlsModule{};NgmControlsModule=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.NgModule)({imports:[_member_list_member_list_component__WEBPACK_IMPORTED_MODULE_2__.N,_smart_filter_smart_filter_component__WEBPACK_IMPORTED_MODULE_3__.O,_smart_select_smart_select_component__WEBPACK_IMPORTED_MODULE_4__.t,_member_tree_member_tree_component__WEBPACK_IMPORTED_MODULE_5__.i,_member_table_member_table_component__WEBPACK_IMPORTED_MODULE_6__.a,_tree_select_tree_select_component__WEBPACK_IMPORTED_MODULE_7__.h,_value_help_value_help_component__WEBPACK_IMPORTED_MODULE_8__.v],exports:[_member_list_member_list_component__WEBPACK_IMPORTED_MODULE_2__.N,_smart_filter_smart_filter_component__WEBPACK_IMPORTED_MODULE_3__.O,_smart_select_smart_select_component__WEBPACK_IMPORTED_MODULE_4__.t,_member_tree_member_tree_component__WEBPACK_IMPORTED_MODULE_5__.i,_member_table_member_table_component__WEBPACK_IMPORTED_MODULE_6__.a,_tree_select_tree_select_component__WEBPACK_IMPORTED_MODULE_7__.h,_value_help_value_help_component__WEBPACK_IMPORTED_MODULE_8__.v],declarations:[],providers:[]})],NgmControlsModule)},"./packages/angular/controls/member-list/member-list.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N:()=>NgmMemberListComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _NgmMemberListComponent,member_list_componentngResource=__webpack_require__("./packages/angular/controls/member-list/member-list.component.scss?ngResource"),member_list_componentngResource_default=__webpack_require__.n(member_list_componentngResource),scrolling=__webpack_require__("./node_modules/@angular/cdk/fesm2022/scrolling.mjs"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),list=__webpack_require__("./node_modules/@angular/material/fesm2022/list.mjs"),progress_spinner=__webpack_require__("./node_modules/@angular/material/fesm2022/progress-spinner.mjs"),fesm2022_radio=__webpack_require__("./node_modules/@angular/material/fesm2022/radio.mjs"),common_module=__webpack_require__("./packages/angular/common/common.module.ts"),displayDensity=__webpack_require__("./packages/angular/core/directives/displayDensity.ts"),core_module=__webpack_require__("./packages/angular/core/core.module.ts"),src=__webpack_require__("./packages/core/src/index.ts"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),tap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js"),combineLatestWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/combineLatestWith.js"),debounceTime=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),startWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),smart_filter_service=__webpack_require__("./packages/angular/controls/smart-filter.service.ts");let NgmMemberListComponent=((_NgmMemberListComponent=class NgmMemberListComponent{get dimension(){return this._dimension()}set dimension(value){this._dimension.set(value)}get options(){return this._options()}set options(value){this._options.set(value)}get displayBehaviour(){return this.dimension?.displayBehaviour}get members(){return this.slicer$.value?.members}constructor(){this._isMemberListComponent=!0,this.smartFilterService=(0,core.inject)(smart_filter_service.o),this._dimension=(0,core.signal)(null),this._options=(0,core.signal)(null),this.loadingChanging=new core.EventEmitter,this.itemSize=48,this.searchControl=new fesm2022_forms.NI,this.multiple=(0,core.computed)((()=>this.options?.multiple??this.options?.selectionType===src.ucB.Multiple)),this.hideSingleSelectionIndicator=(0,core.computed)((()=>this.options?.hideSingleSelectionIndicator)),this.slicer$=new BehaviorSubject.X(null),this.loading$=this.smartFilterService.loading$,this.members$=this.smartFilterService.selectOptions$,this._members=(0,rxjs_interop.O4)(this.members$,{initialValue:[]}),this.selectOptions=(0,rxjs_interop.O4)(this.smartFilterService.selectOptions$.pipe((0,tap.b)((members=>{this.options?.autoActiveFirst&&members?.[0]&&(0,src.xbD)(this.slicer$.value?.members)&&this.slicer$.next({...this.slicer$.value??{},members:[members[0]]})})),(0,combineLatestWith.V)(this.searchControl.valueChanges.pipe((0,debounceTime.b)(300),(0,map.U)((text=>text?`${text}`.toLowerCase():text)),(0,startWith.O)(null))),(0,map.U)((([selectOptions,text])=>{const considerValue=this.displayBehaviour!==src.CXV.descriptionOnly;return(text?selectOptions?.filter((option=>option.caption?.toLowerCase().includes(text)||considerValue&&`${option.value}`.toLowerCase().includes(text))):selectOptions)??[]}))),{initialValue:[]}),this.loadingSub=this.smartFilterService.loading$.pipe((0,rxjs_interop.sL)()).subscribe((loading=>{this.loadingChanging.emit(loading)})),this.serviceSub=this.smartFilterService.onAfterServiceInit().pipe((0,rxjs_interop.sL)()).subscribe((()=>{this.smartFilterService.refresh()})),this.slicerSub=this.slicer$.pipe((0,rxjs_interop.sL)()).subscribe((slicer=>{this.onChange?.({...slicer,dimension:this.dimension})})),(0,core.effect)((()=>{this.smartFilterService.options={...this.options??{},dimension:this.dimension}})),(0,core.effect)((()=>{this.options?.defaultMembers&&this.slicer$.next({...this.slicer$.value??{},members:[...this.options.defaultMembers]})}))}ngOnChanges({dataSettings,appearance}){if(dataSettings?.currentValue&&(this.smartFilterService.dataSettings=dataSettings.currentValue),appearance?.currentValue)switch(this.appearance.displayDensity){case displayDensity.A.compact:this.itemSize=30;break;case displayDensity.A.cosy:this.itemSize=40;break;default:this.itemSize=48}}writeValue(obj){obj&&this.slicer$.next({...obj})}registerOnChange(fn){this.onChange=fn,this.slicer$.value&&this.onChange(this.slicer$.value)}registerOnTouched(fn){}setDisabledState(isDisabled){this.disabled=isDisabled,isDisabled?this.searchControl.disable():this.searchControl.enable()}clearSearch(event){event.stopPropagation(),this.searchControl.setValue("")}compareWith(a,b){return a.value===b.value}onSelectionChange(selection){const members=selection.source.selectedOptions.selected.map((item=>({...item.value})));this.slicer$.next({...this.slicer$.value??{},members}),this.onChange?.(this.slicer$.value)}isSelected(option){return this.members?.findIndex((member=>member.value===option.value))>-1}onRadioChange(event){const member=this._members().find((item=>item.value===event.value));this.slicer$.next({...this.slicer$.value??{},members:member?[{...member}]:[]}),this.onChange?.(this.slicer$.value)}}).ctorParameters=()=>[],_NgmMemberListComponent.propDecorators={_isMemberListComponent:[{type:core.HostBinding,args:["class.ngm-member-list"]}],dataSettings:[{type:core.Input}],dimension:[{type:core.Input}],options:[{type:core.Input}],appearance:[{type:core.Input}],disabled:[{type:core.Input}],loadingChanging:[{type:core.Output}]},_NgmMemberListComponent);NgmMemberListComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-member-list",template:'<ngm-search *ngIf="options?.searchable" class="shrink-0 my-2" [formControl]="searchControl"></ngm-search>\n\n<cdk-virtual-scroll-viewport *ngIf="multiple()" class="ngm-member-list__members" [itemSize]="itemSize">\n  <mat-selection-list role="listbox" class="max-w-full"\n    [compareWith]="compareWith"\n    [displayDensity]="appearance?.displayDensity"\n    (selectionChange)="onSelectionChange($event)">\n    <mat-list-option role="listitem" *cdkVirtualFor="let item of selectOptions()" class="rounded-lg"\n      [value]="item"\n      [selected]="isSelected(item)"\n    >\n      <ngm-display-behaviour class="flex-1"\n        [displayBehaviour]="displayBehaviour"\n        [option]="item"\n        [highlight]="searchControl.value"\n      ></ngm-display-behaviour>\n    </mat-list-option>\n  </mat-selection-list>\n</cdk-virtual-scroll-viewport>\n\n<cdk-virtual-scroll-viewport *ngIf="!multiple()" class="ngm-member-list__members" [itemSize]="itemSize">\n  <mat-selection-list role="listbox" class="max-w-full"\n    (selectionChange)="onSelectionChange($event)"\n    [multiple]="false"\n    [hideSingleSelectionIndicator]="hideSingleSelectionIndicator()"\n    [compareWith]="compareWith"\n    [displayDensity]="appearance?.displayDensity"\n    >\n    <mat-list-option role="listitem" *cdkVirtualFor="let item of selectOptions()" class="rounded-lg"\n      [value]="item"\n      [selected]="isSelected(item)">\n      <ngm-display-behaviour class="flex-1"\n        [displayBehaviour]="displayBehaviour"\n        [option]="item"\n        [highlight]="searchControl.value"\n      ></ngm-display-behaviour>\n    </mat-list-option>\n  </mat-selection-list>\n</cdk-virtual-scroll-viewport>\n\n\n<div *ngIf="loading$ | async" class="absolute top-0 left-0 w-full h-full flex justify-center items-center">\n  <mat-spinner strokeWidth="2" diameter="30"></mat-spinner>\n</div>\n',providers:[smart_filter_service.o,{provide:fesm2022_forms.JU,multi:!0,useExisting:(0,core.forwardRef)((()=>NgmMemberListComponent))}],imports:[common.CommonModule,scrolling.Cl,list.ie,fesm2022_radio.Fk,progress_spinner.Cq,common_module.N,core_module.A],styles:[member_list_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[])],NgmMemberListComponent)},"./packages/angular/controls/member-table/member-table.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>NgmMemberTableComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _NgmMemberTableComponent,member_table_componentngResource=__webpack_require__("./packages/angular/controls/member-table/member-table.component.scss?ngResource"),member_table_componentngResource_default=__webpack_require__.n(member_table_componentngResource),scrolling=__webpack_require__("./node_modules/@angular/cdk/fesm2022/scrolling.mjs"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),fesm2022_checkbox=__webpack_require__("./node_modules/@angular/material/fesm2022/checkbox.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),progress_spinner=__webpack_require__("./node_modules/@angular/material/fesm2022/progress-spinner.mjs"),table=__webpack_require__("./node_modules/@angular/material/fesm2022/table.mjs"),table_data_source=__webpack_require__("./packages/angular/common/table/table-data-source.ts"),common_module=__webpack_require__("./packages/angular/common/common.module.ts"),displayDensity=__webpack_require__("./packages/angular/core/directives/displayDensity.ts"),core_module=__webpack_require__("./packages/angular/core/core.module.ts"),src=__webpack_require__("./packages/core/src/index.ts"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/dist/fesm2022/ngx-translate-core.mjs"),isEqual=__webpack_require__("./node_modules/lodash-es/isEqual.js"),isEmpty=__webpack_require__("./node_modules/lodash-es/isEmpty.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),shareReplay=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js"),distinctUntilChanged=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js"),debounceTime=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js"),smart_filter_service=__webpack_require__("./packages/angular/controls/smart-filter.service.ts");let NgmMemberTableComponent=((_NgmMemberTableComponent=class NgmMemberTableComponent{get dataSettings(){return this._dataSettings()}set dataSettings(value){this._dataSettings.set(value)}get dimension(){return this._dimension()}set dimension(value){this._dimension.set(value)}get options(){return this._options()}set options(value){this._options.set(value)}get appearance(){return this._appearance()}set appearance(value){this._appearance.set(value)}constructor(){this._isMemberTableComponent=!0,this.smartFilterService=(0,core.inject)(smart_filter_service.o),this._dataSettings=(0,core.signal)(null),this._dimension=(0,core.signal)(null),this._options=(0,core.signal)(null),this._appearance=(0,core.signal)(null),this.loadingChanging=new core.EventEmitter,this.slicer=(0,core.signal)(null),this.itemSize=50,this.searchControl=new fesm2022_forms.NI,this.dataSource=new table_data_source.k([]),this.options$=(0,rxjs_interop.Dx)(this._options),this.selctionType$=this.options$.pipe((0,map.U)((options=>options?.selectionType))),this.multiple$=this.selctionType$.pipe((0,map.U)((selctionType=>selctionType===src.ucB.Multiple))),this.slicer$=(0,rxjs_interop.Dx)(this.slicer),this.results$=this.smartFilterService.selectResult(),this.schema$=this.results$.pipe((0,map.U)((result=>result?.schema))),this.columns$=this.schema$.pipe((0,map.U)((schema=>[...schema?.rows??[],...schema?.columns??[]]))),this.displayedColumns$=this.columns$.pipe((0,map.U)((columns=>["select",...columns.map((col=>col.name))])),(0,shareReplay.d)(1)),this.loading$=this.smartFilterService.loading$,this.loadingSub=this.smartFilterService.loading$.pipe((0,rxjs_interop.sL)()).subscribe((loading=>{this.loadingChanging.emit(loading)})),this.serviceSub=this.smartFilterService.onAfterServiceInit().pipe((0,rxjs_interop.sL)()).subscribe((()=>{this.smartFilterService.refresh()})),this.slicerSub=this.slicer$.pipe((0,distinctUntilChanged.x)(isEqual.Z),(0,rxjs_interop.sL)()).subscribe((slicer=>{this.onChange?.({...slicer,dimension:this.dimension})})),this.resultSub=this.results$.pipe((0,rxjs_interop.sL)()).subscribe((results=>{results.data&&(this.dataSource.data=results.data)})),this.searchSub=this.searchControl.valueChanges.pipe((0,debounceTime.b)(500),(0,rxjs_interop.sL)()).subscribe((text=>{this.dataSource.filter=text.trim().toLowerCase()})),(0,core.effect)((()=>{this.smartFilterService.options={...this.options??{},dimension:this.dimension}})),(0,core.effect)((()=>{this.smartFilterService.dataSettings=this.dataSettings})),(0,core.effect)((()=>{switch(this.appearance?.displayDensity){case displayDensity.A.compact:this.itemSize=30;break;case displayDensity.A.cosy:this.itemSize=40;break;default:this.itemSize=50}}))}writeValue(obj){obj&&this.slicer.set({...obj})}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){}setDisabledState(isDisabled){}isAllSelected(){const members=this.slicer()?.members,numSelected=members?.length;return numSelected===this.dataSource.data.length}masterToggle(){this.isAllSelected()?this.clearMembers():this.selectMembers(this.dataSource.data)}hasMember(){const members=this.slicer()?.members;return!(0,isEmpty.Z)(members)}isSelected(row){const members=this.slicer()?.members,value=row.memberKey;return!!members?.find((item=>item.value===value))}toggleMember(row){const caption=(0,src.Imp)(this.dimension,this.smartFilterService.entityType),member={key:row[(0,src.Ex7)(this.dimension)],value:row[(0,src.Ex7)(this.dimension)],label:row[caption],caption:row[caption]},index=this.slicer()?.members?.findIndex((item=>item.key===member.key));index>-1?this.slicer.update((state=>{const members=[...this.slicer().members];return members.splice(index,1),{...state,members}})):(this.slicer.update((state=>({...state??{dimension:this.dimension},members:state?.members??[]}))),this.options?.selectionType===src.ucB.Multiple?this.slicer.update((state=>({...state,members:[...this.slicer().members,member]}))):this.slicer.update((state=>({...state,members:[member]}))))}selectMembers(members){const caption=(0,src.Imp)(this.dimension,this.smartFilterService.entityType);this.slicer.update((state=>({...state,members:members.map((row=>({key:row[(0,src.Ex7)(this.dimension)],value:row[(0,src.Ex7)(this.dimension)],label:row[caption],caption:row[caption]})))})))}clearMembers(){this.slicer.update((state=>({...state,members:[]})))}}).ctorParameters=()=>[],_NgmMemberTableComponent.propDecorators={_isMemberTableComponent:[{type:core.HostBinding,args:["class.ngm-member-table"]}],dataSettings:[{type:core.Input}],dimension:[{type:core.Input}],options:[{type:core.Input}],appearance:[{type:core.Input}],loadingChanging:[{type:core.Output}]},_NgmMemberTableComponent);NgmMemberTableComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-member-table",template:'<ngm-search *ngIf="options?.searchable" class="ngm-member-table__search shrink-0 my-2"\n  [formControl]="searchControl">\n</ngm-search>\n\n<cdk-virtual-scroll-viewport [tvsItemSize]="itemSize" >\n  <table mat-table [dataSource]="dataSource" [displayDensity]="appearance?.displayDensity">\n\n    \x3c!-- Checkbox Column --\x3e\n    <ng-container matColumnDef="select">\n      <th mat-header-cell *matHeaderCellDef>\n        <mat-checkbox *ngIf="multiple$ | async" (change)="$event ? masterToggle() : null"\n                      [checked]="hasMember() && isAllSelected()"\n                      [indeterminate]="hasMember() && !isAllSelected()"\n                      >\n        </mat-checkbox>\n        <span *ngIf="(multiple$ | async) === false">\n          {{ \'Ngm.Common.Select\' | translate: {Default: \'Select\'} }}\n        </span>\n      </th>\n      <td mat-cell *matCellDef="let row">\n        <mat-checkbox (click)="$event.stopPropagation()"\n                      (change)="$event ? toggleMember(row) : null"\n                      [checked]="isSelected(row)"\n                     >\n        </mat-checkbox>\n      </td>\n    </ng-container>\n\n\n    <ng-container [matColumnDef]="col.name" *ngFor="let col of columns$ | async">\n      <th mat-header-cell *matHeaderCellDef> {{col.caption || col.name}} </th>\n      <td mat-cell *matCellDef="let element"> {{element[col.name]}} </td>\n    </ng-container>\n  \n    <tr mat-header-row *matHeaderRowDef="displayedColumns$ | async; sticky: options?.stickyHeader"></tr>\n    <tr mat-row *matRowDef="let row; columns: displayedColumns$ | async;"\n      (click)="toggleMember(row)"></tr>\n  </table>\n</cdk-virtual-scroll-viewport>\n\n<div *ngIf="loading$ | async" class="absolute top-0 left-0 w-full h-full flex justify-center items-center">\n  <mat-spinner strokeWidth="2" diameter="30"></mat-spinner>\n</div>\n',providers:[smart_filter_service.o,{provide:fesm2022_forms.JU,multi:!0,useExisting:(0,core.forwardRef)((()=>NgmMemberTableComponent))}],imports:[common.CommonModule,ngx_translate_core.aw,fesm2022_forms.UX,icon.Ps,fesm2022_checkbox.p9,progress_spinner.Cq,table.p0,scrolling.Cl,core_module.A,common_module.N],styles:[member_table_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[])],NgmMemberTableComponent)},"./packages/angular/controls/member-tree/member-tree.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{i:()=>NgmMemberTreeComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _NgmMemberTreeComponent,member_tree_componentngResource=__webpack_require__("./packages/angular/controls/member-tree/member-tree.component.scss?ngResource"),member_tree_componentngResource_default=__webpack_require__.n(member_tree_componentngResource),scrolling=__webpack_require__("./node_modules/@angular/cdk/fesm2022/scrolling.mjs"),tree=__webpack_require__("./node_modules/@angular/cdk/fesm2022/tree.mjs"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),fesm2022_button=__webpack_require__("./node_modules/@angular/material/fesm2022/button.mjs"),fesm2022_checkbox=__webpack_require__("./node_modules/@angular/material/fesm2022/checkbox.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),progress_spinner=__webpack_require__("./node_modules/@angular/material/fesm2022/progress-spinner.mjs"),fesm2022_tree=__webpack_require__("./node_modules/@angular/material/fesm2022/tree.mjs"),common_module=__webpack_require__("./packages/angular/common/common.module.ts"),displayDensity=__webpack_require__("./packages/angular/core/directives/displayDensity.ts"),core_module=__webpack_require__("./packages/angular/core/core.module.ts"),src=__webpack_require__("./packages/core/src/index.ts"),uniq=__webpack_require__("./node_modules/lodash-es/uniq.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),distinctUntilChanged=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js"),combineLatestWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/combineLatestWith.js"),startWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),smart_filter_service=__webpack_require__("./packages/angular/controls/smart-filter.service.ts");let NgmMemberTreeComponent=((_NgmMemberTreeComponent=class NgmMemberTreeComponent{get displayBehaviour(){return this.dimension()?.displayBehaviour}get treeSelectionMode(){return this.options()?.treeSelectionMode}constructor(smartFilterService){this.smartFilterService=smartFilterService,this._isMemberTreeComponent=!0,this.dataSettings=(0,core.input)(),this.dimension=(0,core.input)(),this.options=(0,core.input)(),this.appearance=(0,core.input)(),this.disabled=(0,core.input)(!1,{transform:core.booleanAttribute}),this._disabled=(0,core.signal)(!1),this.loadingChanging=new core.EventEmitter,this.itemSize=40,this.treeNodePaddingIndent=20,this.unfold=!1,this.searchControl=new fesm2022_forms.NI,this.nestedNodeMap=new Map,this.keyNodeMap=new Map,this.memberKeys=(0,core.signal)([]),this.options$=(0,rxjs_interop.Dx)(this.options),this.onlyLeaves$=this.options$.pipe((0,map.U)((options=>options?.onlyLeaves)),(0,distinctUntilChanged.x)()),this.loading$=this.smartFilterService.loading$,this.slicer=(0,core.computed)((()=>{let nodes=this.memberKeys().map((key=>this.keyNodeMap.get(key))).filter(Boolean);this.options()?.treeSelectionMode===src.OrP.ChildrenOnly?nodes=nodes.filter((node=>!this.treeControl.isExpandable(node)||!(this.childrenPartiallySelected(node)||this.childrenAllSelected(node)))):this.options()?.treeSelectionMode===src.OrP.DescendantsOnly&&(nodes=nodes.filter((node=>!this.treeControl.isExpandable(node)||!(this.descendantsPartiallySelected(node)||this.descendantsAllSelected(node)))));return{dimension:this.dimension(),members:nodes.map((node=>({value:node.key,key:node.key,caption:node.caption})))}})),this.treeNodes=(0,rxjs_interop.O4)(this.smartFilterService.membersWithSchema$.pipe((0,combineLatestWith.V)(this.onlyLeaves$),(0,map.U)((([{members,schema},onlyLeaves])=>schema?.recursiveHierarchy?(0,src.LC)(members,schema?.recursiveHierarchy,{onlyLeaves}):null)))),this.autoActiveFirst=(0,core.computed)((()=>this.options()?.autoActiveFirst)),this.initial=(0,core.signal)(!0),this.loadedTreeNodes=(0,core.effect)((()=>this.initial.set(!0)),{allowSignalWrites:!0}),this.autoActiveFirstEffect=(0,core.effect)((()=>{const treeNodes=this.treeNodes(),firstNode=treeNodes?.[0];if(this.autoActiveFirst()&&firstNode&&this.initial()&&(0,src.xbD)(this.memberKeys())){this.initial.set(!1),this.memberKeys.set([firstNode.key]);const slicer={dimension:this.dimension(),members:[{value:firstNode.key,key:firstNode.key,caption:firstNode.caption}]};this.onChange(slicer)}}),{allowSignalWrites:!0}),this._membersSub=(0,rxjs_interop.Dx)(this.treeNodes).pipe((0,combineLatestWith.V)(this.searchControl.valueChanges.pipe((0,startWith.O)(null),(0,distinctUntilChanged.x)())),(0,map.U)((([treeNodes,text])=>(text=text?.trim(),text?(0,src.NOJ)(treeNodes,text,{considerKey:this.displayBehaviour!==src.CXV.descriptionOnly}):treeNodes))),(0,rxjs_interop.sL)()).subscribe((data=>{data&&(this.dataSource.data=data,(this.options()?.initialLevel>0||this.searchControl.value)&&this.treeControl.dataNodes.forEach((node=>{(this.treeControl.getLevel(node)<this.options().initialLevel||this.searchControl.value&&1===node.childrenCardinality)&&this.treeControl.expand(node)})))})),this._refreshSub=this.smartFilterService.onAfterServiceInit().pipe((0,rxjs_interop.sL)()).subscribe((()=>{this.smartFilterService.refresh()})),this._loadingSub=this.smartFilterService.loading$.pipe((0,rxjs_interop.sL)()).subscribe((loading=>{this.loadingChanging.emit(loading)})),this.transformer=(node,level)=>{const existingNode=this.nestedNodeMap.get(node),flatNode=existingNode&&existingNode.key===node.key?existingNode:{};return flatNode.key=node.key,flatNode.raw=node.raw,flatNode.caption=node.caption,flatNode.level=level,flatNode.expandable=!!node.children?.length,flatNode.childrenCardinality=node.children?.length,this.nestedNodeMap.set(node,flatNode),this.keyNodeMap.set(flatNode.key,flatNode),flatNode},this.getLevel=node=>node.level,this.isExpandable=node=>node.expandable,this.getChildren=node=>node.children,this.treeFlattener=new fesm2022_tree.JZ(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new tree.C2(this.getLevel,this.isExpandable,{trackBy:dataNode=>dataNode.key}),this.dataSource=new fesm2022_tree.kc(this.treeControl,this.treeFlattener),this.dataSource.data=[],(0,core.effect)((()=>{const options=this.options();options&&(this.smartFilterService.options={...options,dimension:this.dimension()},options.defaultMembers&&this.memberKeys.set(options.defaultMembers.map((member=>member.key))))}),{allowSignalWrites:!0}),(0,core.effect)((()=>{const appearance=this.appearance();if(appearance)switch(appearance.displayDensity){case displayDensity.A.compact:this.itemSize=24,this.treeNodePaddingIndent=12;break;case displayDensity.A.cosy:this.itemSize=30,this.treeNodePaddingIndent=15;break;default:this.itemSize=40,this.treeNodePaddingIndent=20}}),{allowSignalWrites:!0}),(0,core.effect)((()=>{const dataSettings=this.dataSettings();dataSettings&&(this.smartFilterService.dataSettings=dataSettings)}),{allowSignalWrites:!0}),(0,core.effect)((()=>{const dimension=this.dimension();dimension&&(this.smartFilterService.options={...this.options??{},dimension})}),{allowSignalWrites:!0})}writeValue(obj){obj&&this.memberKeys.set(obj.members.map((({key})=>key)))}registerOnChange(fn){this.onChange=fn,this.options()?.defaultMembers?.length&&this.onChange({dimension:this.dimension(),members:[...this.options().defaultMembers]})}registerOnTouched(fn){}setDisabledState(isDisabled){this._disabled.set(isDisabled)}refresh(force){this.smartFilterService.refresh(force)}descendantsAllSelected(node){const descendants=this.treeControl.getDescendants(node);return descendants.length>0&&descendants.every((child=>this.isSelected(child.raw)))}descendantsPartiallySelected(node){return this.treeControl.getDescendants(node).some((child=>this.isSelected(child.raw)))&&(!this.descendantsAllSelected(node)||!this.isSelected(node.raw))}childrenAllSelected(node){const level=this.treeControl.getLevel(node);return this.treeControl.getDescendants(node).filter((node=>node.level===level+1)).every((child=>this.isSelected(child.raw)))}childrenPartiallySelected(node){return this.treeControl.getDescendants(node).some((child=>this.isSelected(child.raw)))&&(!this.childrenAllSelected(node)||!this.isSelected(node.raw))}isPartiallySelected(node){return this.options()?.treeSelectionMode===src.OrP.ChildrenOnly||this.options()?.treeSelectionMode===src.OrP.SelfChildren?this.childrenPartiallySelected(node):(this.options()?.treeSelectionMode===src.OrP.DescendantsOnly||this.options()?.treeSelectionMode===src.OrP.SelfDescendants)&&this.descendantsPartiallySelected(node)}isSelected(item){return this.memberKeys().includes(item.memberKey)}toggleMemberKey(key){this.memberKeys.update((members=>members.includes(key)?members.filter((member=>member!==key)):[...members,key]))}selectMembers(...keys){this.memberKeys.update((members=>(0,uniq.Z)([...members,...keys])))}deselectMembers(...keys){this.memberKeys.update((members=>members.filter((item=>-1!==keys.indexOf(item)))))}itemSelectionToggle(node,event){const member=node.raw.memberKey;this.toggleMemberKey(member);const level=this.treeControl.getLevel(node);if(this.options()?.treeSelectionMode===src.OrP.ChildrenOnly||this.options()?.treeSelectionMode===src.OrP.SelfChildren){const children=this.treeControl.getDescendants(node).filter((node=>node.level===level+1)).map((node=>node.raw.memberKey));this.isSelected(node.raw)?this.selectMembers(...children):this.deselectMembers(...children)}else if(this.options()?.treeSelectionMode===src.OrP.SelfDescendants||this.options()?.treeSelectionMode===src.OrP.DescendantsOnly){const descendants=this.treeControl.getDescendants(node).map((node=>node.raw.memberKey));this.isSelected(node.raw)?this.selectMembers(...descendants):this.deselectMembers(...descendants)}this.onChange(this.slicer())}toggleExpand(){this.unfold=!this.unfold,this.unfold?this.treeControl.expandAll():this.treeControl.collapseAll()}}).ctorParameters=()=>[{type:smart_filter_service.o}],_NgmMemberTreeComponent.propDecorators={_isMemberTreeComponent:[{type:core.HostBinding,args:["class.ngm-member-tree"]}],dataSettings:[{type:core.Input,args:[{isSignal:!0,alias:"dataSettings",required:!1,transform:void 0}]}],dimension:[{type:core.Input,args:[{isSignal:!0,alias:"dimension",required:!1,transform:void 0}]}],options:[{type:core.Input,args:[{isSignal:!0,alias:"options",required:!1,transform:void 0}]}],appearance:[{type:core.Input,args:[{isSignal:!0,alias:"appearance",required:!1,transform:void 0}]}],disabled:[{type:core.Input,args:[{isSignal:!0,alias:"disabled",required:!1,transform:void 0}]}],loadingChanging:[{type:core.Output}]},_NgmMemberTreeComponent);NgmMemberTreeComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-member-tree",template:'<div class="flex justify-start items-center">\n  <button mat-icon-button [displayDensity]="appearance()?.displayDensity"\n    (click)="$event.stopPropagation();toggleExpand()">\n    <mat-icon *ngIf="!unfold">unfold_more</mat-icon>\n    <mat-icon *ngIf="unfold">unfold_less</mat-icon>\n  </button>\n  <ngm-search *ngIf="options()?.searchable" class="flex-1" [formControl]="searchControl"></ngm-search>\n</div>\n\n<cdk-virtual-scroll-viewport class="flex-1" [itemSize]="itemSize">\n  <ng-container *cdkVirtualFor="let node of dataSource">\n    \x3c!-- Note that the [style.padding-left] is essentially what cdkTreeNodePadding is doing under the hood --\x3e\n    <div class="tree-node rounded-md" [style.padding-left]="node.level * treeNodePaddingIndent + \'px\'" [displayDensity]="appearance()?.displayDensity">\n      \x3c!-- Note that treeControl.toggle(node) is essentially what cdkTreeNodeToggle is doing under the hood --\x3e\n      <button mat-icon-button disabled *ngIf="!node.expandable" [displayDensity]="appearance()?.displayDensity"></button>\n      <button mat-icon-button *ngIf="node.expandable" [displayDensity]="appearance()?.displayDensity"\n        (click)="treeControl.toggle(node)"\n      >\n        <mat-icon class="mat-icon-rtl-mirror">\n          {{ treeControl.isExpanded(node) ? \'expand_more\' : \'chevron_right\' }}\n        </mat-icon>\n      </button>\n\n      <mat-checkbox\n        [checked]="isSelected(node.raw)"\n        [indeterminate]="isPartiallySelected(node)"\n        (change)="itemSelectionToggle(node, $event)"\n      >\n        <ngm-display-behaviour [displayBehaviour]="displayBehaviour"\n          [option]="{key: node.key, caption: node.caption}"\n          [highlight]="searchControl.value"\n        ></ngm-display-behaviour>\n      </mat-checkbox>\n    </div>\n  </ng-container>\n</cdk-virtual-scroll-viewport>\n\n<div *ngIf="loading$ | async" class="absolute top-0 left-0 w-full h-full flex justify-center items-center">\n  <mat-spinner strokeWidth="2" diameter="30"></mat-spinner>\n</div>\n',providers:[smart_filter_service.o,{provide:fesm2022_forms.JU,multi:!0,useExisting:(0,core.forwardRef)((()=>NgmMemberTreeComponent))}],imports:[common.CommonModule,icon.Ps,fesm2022_checkbox.p9,progress_spinner.Cq,fesm2022_button.ot,scrolling.Cl,core_module.A,common_module.N],styles:[member_tree_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[smart_filter_service.o])],NgmMemberTreeComponent)},"./packages/angular/controls/smart-filter.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{o:()=>NgmSmartFilterService});var _NgmSmartFilterService,tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_metad_ocap_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/angular/core/core.service.ts"),_metad_ocap_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/core/src/index.ts");let NgmSmartFilterService=((_NgmSmartFilterService=class NgmSmartFilterService extends _metad_ocap_core__WEBPACK_IMPORTED_MODULE_0__.Ryo{constructor(dsCoreService){super(dsCoreService)}ngOnDestroy(){super.onDestroy()}}).ctorParameters=()=>[{type:_metad_ocap_angular_core__WEBPACK_IMPORTED_MODULE_1__.q}],_NgmSmartFilterService);NgmSmartFilterService=(0,tslib__WEBPACK_IMPORTED_MODULE_2__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.Injectable)(),(0,tslib__WEBPACK_IMPORTED_MODULE_2__.w6)("design:paramtypes",[_metad_ocap_angular_core__WEBPACK_IMPORTED_MODULE_1__.q])],NgmSmartFilterService)},"./packages/angular/controls/smart-filter/smart-filter.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{O:()=>NgmSmartFilterComponent});var asyncToGenerator=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _NgmSmartFilterComponent,smart_filter_componentngResource=__webpack_require__("./packages/angular/controls/smart-filter/smart-filter.component.scss?ngResource"),smart_filter_componentngResource_default=__webpack_require__.n(smart_filter_componentngResource),coercion=__webpack_require__("./node_modules/@angular/cdk/fesm2022/coercion.mjs"),keycodes=__webpack_require__("./node_modules/@angular/cdk/fesm2022/keycodes.mjs"),scrolling=__webpack_require__("./node_modules/@angular/cdk/fesm2022/scrolling.mjs"),tree=__webpack_require__("./node_modules/@angular/cdk/fesm2022/tree.mjs"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),autocomplete=__webpack_require__("./node_modules/@angular/material/fesm2022/autocomplete.mjs"),fesm2022_button=__webpack_require__("./node_modules/@angular/material/fesm2022/button.mjs"),fesm2022_checkbox=__webpack_require__("./node_modules/@angular/material/fesm2022/checkbox.mjs"),dialog=__webpack_require__("./node_modules/@angular/material/fesm2022/dialog.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),input=__webpack_require__("./node_modules/@angular/material/fesm2022/input.mjs"),menu=__webpack_require__("./node_modules/@angular/material/fesm2022/menu.mjs"),progress_spinner=__webpack_require__("./node_modules/@angular/material/fesm2022/progress-spinner.mjs"),tooltip=__webpack_require__("./node_modules/@angular/material/fesm2022/tooltip.mjs"),fesm2022_tree=__webpack_require__("./node_modules/@angular/material/fesm2022/tree.mjs"),common_module=__webpack_require__("./packages/angular/common/common.module.ts"),displayDensity=__webpack_require__("./packages/angular/core/directives/displayDensity.ts"),core_module=__webpack_require__("./packages/angular/core/core.module.ts"),src=__webpack_require__("./packages/core/src/index.ts"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/dist/fesm2022/ngx-translate-core.mjs"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),combineLatest=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js"),startWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),combineLatestWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/combineLatestWith.js"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),distinctUntilChanged=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js"),firstValueFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js"),smart_filter_service=__webpack_require__("./packages/angular/controls/smart-filter.service.ts"),value_help_component=__webpack_require__("./packages/angular/controls/value-help/value-help.component.ts"),fesm2022_radio=__webpack_require__("./node_modules/@angular/material/fesm2022/radio.mjs");let NgmSmartFilterComponent=((_NgmSmartFilterComponent=class NgmSmartFilterComponent{get dataSettings(){return this._dataSettings()}set dataSettings(value){this._dataSettings.set(value)}get dimension(){return this._dimension()}set dimension(value){this._dimension.set(value)}get options(){return this._options()}set options(value){this._options.set(value)}get slicer(){return this.slicer$.value}set slicer(value){this.slicer$.next(value)}get appearance(){return this._appearance()}set appearance(value){this._appearance.set(value)}get displayDensity(){return this.displayDensity$()}set displayDensity(value){this.displayDensity$.set(displayDensity.A[value])}get disabled(){return this.disabled$()}set disabled(value){this.disabled$.set((0,coercion.Ig)(value))}get multiple(){return this.options?.multiple}get hierarchy(){return this.dimension?.hierarchy??this.dimension?.dimension}set hierarchy(value){this.dimension={...this.dimension,hierarchy:value,level:null}}get displayBehaviour(){return this.dimension?.displayBehaviour??src.CXV.descriptionOnly}get searchHighlight(){return this.valueControl.value}constructor(){this.smartFilterService=(0,core.inject)(smart_filter_service.o),this._dialog=(0,core.inject)(dialog.uw),this._viewContainerRef=(0,core.inject)(core.ViewContainerRef),this._dataSettings=(0,core.signal)(null),this._dimension=(0,core.signal)(null),this._options=(0,core.signal)(null),this.slicer$=new BehaviorSubject.X({}),this.members=(0,core.signal)(null),this._appearance=(0,core.signal)(null),this.displayDensity$=(0,core.signal)(null),this.disabled$=(0,core.signal)(!1),this.loadingChanging=new core.EventEmitter,this._displayDensity=(0,core.computed)((()=>this.displayDensity$()??this._appearance()?.displayDensity)),this.virtualScrollItemSize=48,this.treeNodePaddingIndent=20,this.transformer=(node,level)=>({expandable:!!node.children&&node.children.length>0,key:node.key,caption:node.caption,value:node.value,level,childrenCardinality:node.children?.length,raw:node.raw}),this.treeControl=new tree.C2((node=>node.level),(node=>node.expandable)),this.treeFlattener=new fesm2022_tree.JZ(this.transformer,(node=>node.level),(node=>node.expandable),(node=>node.children)),this.dataSource=new fesm2022_tree.kc(this.treeControl,this.treeFlattener),this.selectOptions$=this.dataSource.connect({viewChange:(0,of.of)()}),this.entityType=(0,rxjs_interop.O4)(this.smartFilterService.selectEntityType()),this.options$=(0,rxjs_interop.Dx)(this._options),this.property=(0,core.computed)((()=>(0,src.ZBB)(this.entityType(),this.dimension))),this.hierarchies=(0,core.computed)((()=>this.property()?.hierarchies)),this.label=(0,core.computed)((()=>this.options?.label||this.property()?.caption||this.property()?.name)),this.placeholder$=this.options$.pipe((0,map.U)((options=>options?.placeholder))),this.selectionType$=this.options$.pipe((0,map.U)((options=>options?.selectionType))),this.multiple$=this.selectionType$.pipe((0,map.U)((selectionType=>selectionType===src.ucB.Multiple))),this.maxTagCount=(0,core.computed)((()=>this.options?.maxTagCount??1)),this.autoActiveFirst$=this.options$.pipe((0,map.U)((options=>options?.autoActiveFirst))),this.members$=(0,combineLatest.a)([this.slicer$.pipe((0,map.U)((slicer=>slicer?.members))),this.smartFilterService.selectOptions$]).pipe((0,map.U)((([members,selectOptions])=>members?.map((({key,value,caption})=>({key,value,caption:selectOptions?.find((item=>item.value===value))?.caption??caption})))))),this.loading$=this.smartFilterService.loading$,this.membersSignal=(0,rxjs_interop.O4)(this.members$),this.isNotInitial=(0,core.computed)((()=>!!this.membersSignal()?.length)),this.restChips=(0,core.signal)([]),this.chips$=this.members$.pipe((0,map.U)((selectedMembers=>{const _chips=selectedMembers?[...selectedMembers]:[];return this.restChips.set(this.maxTagCount()?_chips.splice(this.maxTagCount()).map((({caption})=>caption)):[]),_chips}))),this.membersTree$=this.smartFilterService.membersTree$,this.valueControl=new fesm2022_forms.NI,this.selectable=!0,this.removable=!0,this.addOnBlur=!0,this.filteredOptions$=this.valueControl.valueChanges.pipe((0,map.U)((text=>text?`${text}`.toLowerCase():text)),(0,startWith.O)(null),(0,combineLatestWith.V)(this.selectOptions$),(0,map.U)((([text,selectOptions])=>(text?selectOptions?.filter((option=>option.caption?.toLowerCase().includes(text)||`${option.value}`.toLowerCase().includes(text))):selectOptions)??[]))),this.separatorKeysCodes=[keycodes.K5,keycodes.OC],this.loadingSub=this.smartFilterService.loading$.pipe((0,rxjs_interop.sL)()).subscribe((loading=>{this.loadingChanging.emit(loading)})),this.serviceSub=this.smartFilterService.onAfterServiceInit().pipe((0,rxjs_interop.sL)()).subscribe((()=>{this.smartFilterService.refresh()})),this.slicerSub=this.slicer$.pipe((0,rxjs_interop.sL)()).subscribe((slicer=>{slicer.dimension={...this.dimension},this.onChange?.(slicer)})),this._treeNodesSub=this.membersTree$.pipe((0,combineLatestWith.V)(this.valueControl.valueChanges.pipe((0,filter.h)((value=>!value||"string"==typeof value)),(0,startWith.O)(null),(0,distinctUntilChanged.x)())),(0,map.U)((([treeNodes,text])=>(0,src.NOJ)(treeNodes??[],text,{considerKey:this.displayBehaviour!==src.CXV.descriptionOnly})))).subscribe((nodes=>{this.dataSource.data=nodes,(this.options?.initialLevel||this.valueControl.value)&&this.treeControl.dataNodes.forEach((node=>{(this.treeControl.getLevel(node)<this.options.initialLevel||this.valueControl.value&&1===node.childrenCardinality)&&this.treeControl.expand(node)}))})),(0,core.effect)((()=>{this.dataSettings&&(this.smartFilterService.dataSettings=this.dataSettings)}),{allowSignalWrites:!0}),(0,core.effect)((()=>{this.smartFilterService.options={...this.options??{},dimension:this.dimension}})),(0,core.effect)((()=>{this.options?.defaultMembers&&(this.slicer={...this.slicer,members:[...this.options.defaultMembers]})})),(0,core.effect)((()=>{this._displayDensity()&&(this._displayDensity()===displayDensity.A.compact?(this.treeNodePaddingIndent=10,this.virtualScrollItemSize=30):this._displayDensity()===displayDensity.A.cosy?(this.treeNodePaddingIndent=15,this.virtualScrollItemSize=36):(this.treeNodePaddingIndent=20,this.virtualScrollItemSize=48))})),(0,core.effect)((()=>{this.disabled?this.valueControl.disable():this.valueControl.enable()}))}writeValue(obj){obj&&(this.slicer=obj)}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){}setDisabledState(isDisabled){this.disabled=isDisabled,isDisabled?this.valueControl.disable():this.valueControl.enable()}trackBy(index,item){return item.key}trackByKey(index,item){return item.key}trackByName(index,item){return item?.name}displayWithCaption(member){return member?.caption||member?.key}isSelected(option){return this.slicer.members?.some((member=>member.key===option.key))}onCheckboxChange(event,option){event.checked?this.toggleMember({key:option.key,value:option.key,caption:option.caption}):this.removeMember({key:option.key,value:option.key,caption:option.caption})}removeMember({key}){this.slicer={...this.slicer,members:this.slicer.members.filter((member=>member.key!==key))}}clearMembers(){this.slicer={...this.slicer,members:[]}}selectMember(event){const memberFlatNode=event.option.value;this.toggleMember({key:memberFlatNode.key,value:memberFlatNode.key,caption:memberFlatNode.caption}),this.searchInput.nativeElement.value="",this.valueControl.setValue(null),this.searchInput.nativeElement.blur()}onMemberSelect({event,member}){let members=this.slicer.members??[];if(event.checked)if(this.options?.multiple||this.options?.selectionType===src.ucB.Multiple){const index=members.findIndex((item=>item.key===member.key));index>-1&&members.splice(index,1),members.push({key:member.key,value:member.value,label:member.caption})}else members=[{key:member.key,value:member.value,label:member.caption}];else{const index=members.findIndex((item=>item.key===member.key));index>-1&&members.splice(index,1)}this.slicer={...this.slicer,members}}toggleMember(member){let members=this.slicer.members?[...this.slicer.members]:[];if(this.options?.multiple||this.options?.selectionType===src.ucB.Multiple){const index=members.findIndex((item=>item.key===member.key));index>-1?members.splice(index,1):members.push({key:member.key,value:member.value,label:member.caption})}else members=[{key:member.key,value:member.value,label:member.caption}];this.slicer={...this.slicer,members}}openValueHelp(event){var _this=this;return(0,asyncToGenerator.Z)((function*(){const slicer=yield(0,firstValueFrom.z)(_this._dialog.open(value_help_component.v,{viewContainerRef:_this._viewContainerRef,data:{dataSettings:_this.dataSettings,dimension:_this.dimension,options:{..._this.options??{},selectionType:_this.options?.selectionType??(_this.options?.multiple?src.ucB.Multiple:null),searchable:!0,initialLevel:1},slicer:_this.slicer}}).afterClosed());slicer&&(_this.dimension={..._this.dimension,hierarchy:slicer.dimension.hierarchy,displayBehaviour:slicer.dimension.displayBehaviour},_this.slicer={..._this.slicer,members:slicer.members??[],exclude:slicer.exclude})}))()}onAutocompleteOpened(){this.cdkVirtualScrollViewPort?.checkViewportSize()}}).ctorParameters=()=>[],_NgmSmartFilterComponent.propDecorators={dataSettings:[{type:core.Input}],dimension:[{type:core.Input}],options:[{type:core.Input}],appearance:[{type:core.Input}],displayDensity:[{type:core.Input}],disabled:[{type:core.Input}],loadingChanging:[{type:core.Output}],cdkVirtualScrollViewPort:[{type:core.ViewChild,args:[scrolling.N7,{static:!1}]}],searchInput:[{type:core.ViewChild,args:["search"]}]},_NgmSmartFilterComponent);NgmSmartFilterComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-smart-filter",template:'<label class="p-1 text-sm text-ellipsis whitespace-nowrap overflow-hidden disabled:opacity-50">\n    {{ label() }}\n</label>\n\n<div class="w-full relative flex items-center rounded-md">\n  <div class="absolute left-0 max-w-[75%] overflow-hidden flex items-center px-1">\n    <ng-content select="[ngmPrefix]"></ng-content>\n\n    <ng-container *ngIf="isNotInitial()">\n      <ngm-tags class="overflow-hidden"\n        [tags]="chips$ | async"\n        [exclude]="slicer?.exclude"\n        color="primary">\n      </ngm-tags>\n\n      <span *ngIf="restChips().length" class="cursor-pointer shrink-0" [matTooltip]="restChips().join(\'; \')">\n        +{{restChips().length}}\n      </span>\n      <mat-icon class="cursor-pointer shrink-0 text-neutral-400" displayDensity="compact" ngmAppearance="danger"\n        [class.cursor-not-allowed]="disabled"\n        (click)="disabled ? null : clearMembers()">close</mat-icon>\n    </ng-container>\n  </div>\n\n  <input #search matInput class="ngm-input-element ngm-w-full"\n    [class.ngm-input__searching]="!!searchHighlight"\n    [placeholder]="placeholder$ | async"\n    [formControl]="valueControl"\n    [matAutocomplete]="auto"\n  >\n  <div class="ngm-smart-filter__suffix flex items-center">\n    <mat-spinner *ngIf="loading$ | async" [color]="appearance?.color" strokeWidth="1" diameter="20"></mat-spinner>\n\n    <button mat-icon-button *ngIf="hierarchies()?.length > 1" class="ngm-actionable-opacity"\n      displayDensity="compact"\n      [disabled]="disabled"\n      [matMenuTriggerFor]="hierarchiesMenu"\n      #mt="matMenuTrigger"\n      [class.active]="mt.menuOpen"\n      (click)="$event.stopPropagation();$event.preventDefault();">\n      <mat-icon fontSet="material-icons-outlined">account_tree</mat-icon>\n    </button>\n    <button mat-icon-button type="button" class="ngm-actionable-opacity" displayDensity="compact"\n      [disabled]="disabled"\n      (click)="$event.stopPropagation();$event.preventDefault();openValueHelp($event)"\n    >\n      <mat-icon>help_outline</mat-icon>\n    </button>\n\n    <ng-content select="[ngmSuffix]"></ng-content>\n  </div>\n</div>\n\n<mat-autocomplete #auto="matAutocomplete" class="ngm-tree-select__panel"\n  [class]="\'ngm-autocomplete-panel \' + (multiple ? \'multiple\' : \'\') + \' \' + (_displayDensity() === \'compact\' ? \'ngm-density__compact\' : \'\') + \' \' + (_displayDensity()===\'cosy\' ? \'ngm-density__cosy\' : \'\')"\n  [autoActiveFirstOption]="options?.autoActiveFirst"\n  [displayWith]="displayWithCaption"\n  (opened)="onAutocompleteOpened()"\n  (optionSelected)="selectMember($event)">\n  <cdk-virtual-scroll-viewport class="ngm-smart-filter__autocomplete-viewport ngm-tree-select__viewport" minBufferPx="200" maxBufferPx="400"\n    [itemSize]="virtualScrollItemSize"\n  >\n    <mat-option *cdkVirtualFor="let option of selectOptions$ | async; trackBy: trackByKey" [value]="option"\n      [class.mat-selected]="isSelected(option)"\n    >\n\n      <div class="flex-1 flex justify-start items-center" >\n        <button mat-icon-button [displayDensity]="_displayDensity()"\n          [style.visibility]="!option.expandable ? \'hidden\' : \'\'"\n          [style.marginLeft.px]="option.level * treeNodePaddingIndent"\n          (click)="$event.stopPropagation(); treeControl.toggle(option)">\n          <mat-icon class="mat-icon-rtl-mirror">\n            {{treeControl.isExpanded(option) ? \'expand_more\' : \'chevron_right\'}}\n          </mat-icon>\n        </button>\n\n        <mat-checkbox *ngIf="options?.multiple" class="flex-1"\n          [checked]="isSelected(option)"\n          (click)="$event.stopPropagation()"\n          (change)="onCheckboxChange($event, option)"\n        >\n          <ngm-display-behaviour [option]="{value: option.key, label: option.caption}"\n            [displayBehaviour]="displayBehaviour"\n            [highlight]="searchHighlight">\n          </ngm-display-behaviour>\n        </mat-checkbox>\n\n        <ngm-display-behaviour *ngIf="!options?.multiple" class="flex-1"\n          [option]="{value: option.key, label: option.caption}"\n          [displayBehaviour]="displayBehaviour"\n          [highlight]="searchHighlight">\n        </ngm-display-behaviour>\n      </div>\n\n    </mat-option>\n  </cdk-virtual-scroll-viewport>\n</mat-autocomplete>\n\n<mat-radio-group [(ngModel)]="hierarchy">\n  <mat-menu #hierarchiesMenu="matMenu" class="ngm-density__compact">\n    <button mat-menu-item disableRipple *ngFor="let property of hierarchies(); trackBy: trackByName"\n      (click)="$event.stopPropagation();">\n      <mat-radio-button class="ngm-radio-button__property flex-1" [value]="property.name">\n        <ngm-property class="flex-1" hiddenIcon [property]="property" />\n      </mat-radio-button>\n    </button>\n  </mat-menu>\n</mat-radio-group>\n',host:{class:"ngm-smart-filter"},providers:[smart_filter_service.o,{provide:fesm2022_forms.JU,multi:!0,useExisting:(0,core.forwardRef)((()=>NgmSmartFilterComponent))}],imports:[common.CommonModule,fesm2022_forms.u5,ngx_translate_core.aw,fesm2022_forms.UX,fesm2022_button.ot,icon.Ps,progress_spinner.Cq,autocomplete.Bb,input.c,tooltip.AV,menu.Tx,fesm2022_radio.Fk,fesm2022_checkbox.p9,scrolling.Cl,core_module.A,common_module.N],styles:[smart_filter_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[])],NgmSmartFilterComponent)},"./packages/angular/controls/smart-select/smart-select.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{t:()=>NgmSmartSelectComponent});var asyncToGenerator=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _NgmSmartSelectComponent,smart_select_componentngResource=__webpack_require__("./packages/angular/controls/smart-select/smart-select.component.scss?ngResource"),smart_select_componentngResource_default=__webpack_require__.n(smart_select_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),displayDensity=__webpack_require__("./packages/angular/core/directives/displayDensity.ts"),appearance=__webpack_require__("./packages/angular/core/directives/appearance.ts"),src=__webpack_require__("./packages/core/src/index.ts"),combineLatestWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/combineLatestWith.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),combineLatest=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js"),distinctUntilChanged=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),withLatestFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/withLatestFrom.js"),switchMap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),shareReplay=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js"),firstValueFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js"),smart_filter_service=__webpack_require__("./packages/angular/controls/smart-filter.service.ts"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),form_field=__webpack_require__("./node_modules/@angular/material/fesm2022/form-field.mjs"),fesm2022_select=__webpack_require__("./node_modules/@angular/material/fesm2022/select.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),progress_spinner=__webpack_require__("./node_modules/@angular/material/fesm2022/progress-spinner.mjs"),fesm2022_button=__webpack_require__("./node_modules/@angular/material/fesm2022/button.mjs");let NgmSmartSelectComponent=((_NgmSmartSelectComponent=class NgmSmartSelectComponent{get dataSettings(){return this._dataSettings()}set dataSettings(value){this._dataSettings.set(value)}get dimension(){return this._dimension()}set dimension(value){this._dimension.set(value)}get options(){return this._options()}set options(value){this._options.set(value)}get displayBehaviour(){return this.dimension?.displayBehaviour??src.CXV.descriptionOnly}constructor(){this.smartFilterService=(0,core.inject)(smart_filter_service.o),this._dataSettings=(0,core.signal)(null),this._dimension=(0,core.signal)(null),this._options=(0,core.signal)(null),this.options$=(0,rxjs_interop.Dx)(this._options),this.loadingChanging=new core.EventEmitter,this.property$=(0,rxjs_interop.Dx)(this._dimension).pipe((0,combineLatestWith.V)(this.smartFilterService.selectEntityType()),(0,map.U)((([dimension,entityType])=>(0,src.ZBB)(entityType,dimension)))),this.label$=(0,combineLatest.a)([this.options$.pipe((0,map.U)((options=>options?.label))),this.property$]).pipe((0,map.U)((([label,property])=>label||property?.caption||property?.name))),this.placeholder$=this.options$.pipe((0,map.U)((options=>options?.placeholder))),this.autoActiveFirst$=this.options$.pipe((0,map.U)((options=>options?.autoActiveFirst))),this.multiple$=this.options$.pipe((0,map.U)((options=>options?.selectionType===src.ucB.Multiple||options?.multiple)),(0,distinctUntilChanged.x)()),this.slicer$=new BehaviorSubject.X(null),this.members$=this.slicer$.pipe((0,map.U)((slicer=>slicer?.members))),this.memberValues$=this.members$.pipe((0,withLatestFrom.M)(this.multiple$),(0,map.U)((([members,multiple])=>multiple?members?.map((({value})=>value)):members?.[0]?.value)),(0,distinctUntilChanged.x)(src.Xyp)),this.isInitial$=this.members$.pipe((0,map.U)((members=>(0,src.xbD)(members)))),this.data$=this.options$.pipe((0,map.U)((options=>options?.data))),this.selectOptions$=this.data$.pipe((0,map.U)((data=>data?.filter((item=>!!item)))),(0,switchMap.w)((data=>(0,src.xbD)(data)?this.smartFilterService.selectOptions$:(0,of.of)(data))),(0,withLatestFrom.M)(this.autoActiveFirst$,this.members$),(0,map.U)((([selectOptions,autoActiveFirst,members])=>(selectOptions[0]&&autoActiveFirst&&(0,src.xbD)(members)&&this.toggleMember(selectOptions[0]),selectOptions))),(0,rxjs_interop.sL)(),(0,shareReplay.d)(1)),this.loading$=this.smartFilterService.loading$,this.loadingSub=this.smartFilterService.loading$.pipe((0,rxjs_interop.sL)()).subscribe((loading=>{this.loadingChanging.emit(loading)})),this.serviceSub=this.smartFilterService.onAfterServiceInit().pipe((0,rxjs_interop.sL)()).subscribe((()=>{this.smartFilterService.refresh()})),this.slicerSub=this.slicer$.pipe((0,rxjs_interop.sL)()).subscribe((slicer=>{this.onChange?.({...slicer,dimension:this.dimension})})),(0,core.effect)((()=>{this.dataSettings&&(this.smartFilterService.dataSettings=this.dataSettings)})),(0,core.effect)((()=>{this.smartFilterService.options={...this.options??{},dimension:this.dimension}})),(0,core.effect)((()=>{this.options?.defaultMembers&&this.setMembers(this.options.defaultMembers)}),{allowSignalWrites:!0})}writeValue(obj){obj&&this.slicer$.next(obj)}registerOnChange(fn){this.onChange=fn,this.slicer$.value&&this.onChange(this.slicer$.value)}registerOnTouched(fn){}setDisabledState(isDisabled){this.disabled=isDisabled}toggleMember(member){const slicer=this.slicer$.value??{dimension:this.dimension};if(this.options?.selectionType===src.ucB.Multiple){const index=slicer.members?.findIndex((item=>item.value===member.value));index>-1?slicer.members.splice(index,1):(slicer.members=slicer.members??[],slicer.members.push({key:member.key,value:member.value,caption:member.caption}))}else slicer.members=[{key:member.key,value:member.value,caption:member.caption}];this.slicer$.next(slicer),this.onChange?.(slicer)}setSelectedValues(values){var _this=this;return(0,asyncToGenerator.Z)((function*(){const selectOptions=yield(0,firstValueFrom.z)(_this.selectOptions$);values=Array.isArray(values)?values:(0,src.kKJ)(values)?null:[values],_this.setMembers(values?.map((value=>selectOptions.find((item=>item.key===value))??{value,key:value})))}))()}setMembers(members){const slicer=this.slicer$.value??{dimension:this.dimension};slicer.members=[...members??[]],this.slicer$.next(slicer),this.onChange?.(slicer)}}).ctorParameters=()=>[],_NgmSmartSelectComponent.propDecorators={dataSettings:[{type:core.Input}],dimension:[{type:core.Input}],options:[{type:core.Input}],appearance:[{type:core.Input}],disabled:[{type:core.Input}],loadingChanging:[{type:core.Output}]},_NgmSmartSelectComponent);NgmSmartSelectComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,imports:[common.CommonModule,fesm2022_forms.u5,form_field.lN,fesm2022_select.LD,icon.Ps,fesm2022_button.ot,progress_spinner.Cq,displayDensity.Z,appearance.A],selector:"ngm-smart-select",template:'<label *ngIf="appearance?.displayDensity === \'cosy\' || appearance?.displayDensity === \'compact\'">{{label$ | async}}</label>\n\n<mat-form-field class="flex-1"\n  [appearance]="appearance?.appearance"\n  [floatLabel]="appearance?.floatLabel"\n  [color]="appearance?.color"\n  [displayDensity]="appearance?.displayDensity"\n>\n  <mat-label>{{label$ | async}}</mat-label>\n  @if (multiple$ | async) {\n    <mat-select [placeholder]="placeholder$ | async"\n      [disabled]="disabled"\n      [ngModel]="memberValues$ | async"\n      (ngModelChange)="setSelectedValues($event)"\n      multiple\n    >\n      @for (option of selectOptions$ | async; track option.key) {\n        <mat-option [value]="option.key ?? option.value">\n          {{ option.caption || (option.key ?? option.value) }}\n        </mat-option>\n      }\n    </mat-select>\n  } @else {\n    <mat-select [placeholder]="placeholder$ | async"\n    [disabled]="disabled"\n    [ngModel]="memberValues$ | async"\n    (ngModelChange)="setSelectedValues($event)"\n  >\n    @for (option of selectOptions$ | async; track option.key) {\n      <mat-option [value]="option.key ?? option.value">\n        {{ option.caption || (option.key ?? option.value) }}\n      </mat-option>\n    }\n  </mat-select>\n  }\n\n  <div matSuffix class="flex items-center">\n    <button *ngIf="(isInitial$ | async) === false" mat-icon-button [disabled]="disabled" aria-label="Clear"\n      ngmAppearance="danger"\n      (click)="$event.stopPropagation();setMembers(null)">\n      <mat-icon>close</mat-icon>\n    </button>\n\n    <mat-spinner *ngIf="loading$ | async" color="primary" strokeWidth="1" diameter="20"></mat-spinner>\n\n    <ng-content></ng-content>\n  </div>\n</mat-form-field>\n',host:{class:"ngm-smart-select"},providers:[smart_filter_service.o,{provide:fesm2022_forms.JU,multi:!0,useExisting:(0,core.forwardRef)((()=>NgmSmartSelectComponent))}],styles:[smart_select_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[])],NgmSmartSelectComponent)},"./packages/angular/controls/tree-select/tree-select.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{h:()=>NgmMemberTreeSelectComponent});var asyncToGenerator=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _NgmMemberTreeSelectComponent,tree_select_componentngResource=__webpack_require__("./packages/angular/controls/tree-select/tree-select.component.scss?ngResource"),tree_select_componentngResource_default=__webpack_require__.n(tree_select_componentngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),fesm2022_button=__webpack_require__("./node_modules/@angular/material/fesm2022/button.mjs"),dialog=__webpack_require__("./node_modules/@angular/material/fesm2022/dialog.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),menu=__webpack_require__("./node_modules/@angular/material/fesm2022/menu.mjs"),progress_spinner=__webpack_require__("./node_modules/@angular/material/fesm2022/progress-spinner.mjs"),fesm2022_radio=__webpack_require__("./node_modules/@angular/material/fesm2022/radio.mjs"),common_module=__webpack_require__("./packages/angular/common/common.module.ts"),core_module=__webpack_require__("./packages/angular/core/core.module.ts"),src=__webpack_require__("./packages/core/src/index.ts"),firstValueFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js"),smart_filter_service=__webpack_require__("./packages/angular/controls/smart-filter.service.ts"),value_help_component=__webpack_require__("./packages/angular/controls/value-help/value-help.component.ts");let NgmMemberTreeSelectComponent=((_NgmMemberTreeSelectComponent=class NgmMemberTreeSelectComponent{get dataSettings(){return this.dataSettings$()}set dataSettings(value){this.dataSettings$.set(value)}get dimension(){return this.dimensionSignal()}set dimension(value){this.dimensionSignal.set(value)}get options(){return this.options$()}set options(value){this.options$.set(value)}get displayBehaviour(){return this.dimension?.displayBehaviour??src.CXV.descriptionOnly}get hierarchy(){return this.dimension?.hierarchy??this.dimension?.dimension}set hierarchy(value){this.dimension={...this.dimension,hierarchy:value,level:null}}constructor(){this._isMemberTreeSelectComponent=!0,this.DisplayBehaviour=src.CXV,this.smartFilterService=(0,core.inject)(smart_filter_service.o),this._dialog=(0,core.inject)(dialog.uw),this._viewContainerRef=(0,core.inject)(core.ViewContainerRef),this.dataSettings$=(0,core.signal)(null),this.dimensionSignal=(0,core.signal)(null),this.options$=(0,core.signal)({}),this.loadingChanging=new core.EventEmitter,this.slicer=(0,core.signal)(null),this.memberKeys=(0,core.computed)((()=>(this.slicer()?.members??[]).map((member=>member.value)))),this.members=(0,rxjs_interop.O4)(this.smartFilterService.selectOptions$),this.entityType=(0,rxjs_interop.O4)(this.smartFilterService.selectEntityType()),this.property=(0,core.computed)((()=>(0,src.ZBB)(this.entityType(),this.dimensionSignal()))),this.label=(0,core.computed)((()=>this.options$().label||this.property()?.caption||this.property()?.name)),this.hierarchies=(0,core.computed)((()=>this.property()?.hierarchies)),this.treeData$=this.smartFilterService.membersTree$,this.loading$=this.smartFilterService.loading$,this._refreshSub=this.smartFilterService.onAfterServiceInit().subscribe((()=>{this.smartFilterService.refresh()})),this._loadingSub=this.smartFilterService.loading$.subscribe((loading=>{this.loadingChanging.emit(loading)})),(0,core.effect)((()=>{null!==this.slicer()&&this.onChange?.(this.slicer())})),(0,core.effect)((()=>{this.options.defaultMembers?.length&&!this.slicer()&&this.slicer.set({...this.slicer()??{},dimension:this.dimension,members:this.options.defaultMembers})}),{allowSignalWrites:!0}),(0,core.effect)((()=>{this.dimension&&(this.smartFilterService.options={...this.options,dimension:this.dimension})}))}ngOnChanges({dataSettings,dimension,options}){dataSettings?.currentValue&&(this.smartFilterService.dataSettings=dataSettings.currentValue)}writeValue(obj){obj&&this.slicer.set(obj)}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){}setDisabledState(isDisabled){this.disabled=isDisabled}displayFn(item){return"string"==typeof item?item:item?.label||item?.key}trackByName(index,item){return item?.name}onModelChange(event){this.slicer.set({...this.slicer()??{},dimension:this.dimension,members:Array.isArray(event)?event.map((key=>({key,value:key,caption:this.members()?.find((item=>item.key===key))?.caption}))):event?[{key:event,value:event,caption:this.members()?.find((item=>item.key===event))?.caption}]:null})}openValueHelp(event){var _this=this;return(0,asyncToGenerator.Z)((function*(){const slicer=yield(0,firstValueFrom.z)(_this._dialog.open(value_help_component.v,{viewContainerRef:_this._viewContainerRef,data:{dataSettings:_this.dataSettings,dimension:_this.dimension,options:{..._this.options??{},selectionType:_this.options?.selectionType??(_this.options?.multiple?src.ucB.Multiple:null),searchable:!0,initialLevel:1},slicer:_this.slicer()}}).afterClosed());slicer&&(_this.dimension={..._this.dimension,hierarchy:slicer.dimension.hierarchy,displayBehaviour:slicer.dimension.displayBehaviour},slicer.members.length>1&&(_this.options.multiple=!0),_this.slicer.set({..._this.slicer()??{},dimension:_this.dimension,members:slicer.members??[],exclude:slicer.exclude}))}))()}}).ctorParameters=()=>[],_NgmMemberTreeSelectComponent.propDecorators={_isMemberTreeSelectComponent:[{type:core.HostBinding,args:["class.ngm-member-tree-select"]}],data:[{type:core.Input}],dataSettings:[{type:core.Input}],dimension:[{type:core.Input}],appearance:[{type:core.Input}],options:[{type:core.Input}],disabled:[{type:core.Input}],loadingChanging:[{type:core.Output}]},_NgmMemberTreeSelectComponent);NgmMemberTreeSelectComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,selector:"ngm-member-tree-select",template:'<label *ngIf="appearance?.displayDensity === \'cosy\' || appearance?.displayDensity === \'compact\'">{{label()}}</label>\n<ngm-tree-select class="flex-1 max-w-full"\n  [appearance]="appearance?.appearance"\n  [floatLabel]="appearance?.floatLabel"\n  [color]="appearance?.color"\n  [displayBehaviour]="displayBehaviour"\n  [displayDensity]="appearance?.displayDensity"\n  [label]="label()"\n  [placeholder]="options?.placeholder"\n  [treeNodes]="data || (treeData$ | async)"\n  [initialLevel]="options?.initialLevel"\n  [multiple]="options?.multiple"\n  [maxTagCount]="options?.maxTagCount"\n  [virtualScroll]="options?.virtualScroll"\n  [autocomplete]="options?.autocomplete"\n  [searchable]="options?.searchable"\n  [panelWidth]="options?.panelWidth"\n  [autoActiveFirstOption]="options?.autoActiveFirst"\n  [autoSelectActiveOption]="options?.autoSelectActive"\n  [disabled]="disabled"\n  [ngModel]="memberKeys()"\n  (ngModelChange)="onModelChange($event)"\n>\n  <div matSuffix style="display: flex; align-items: center;">\n    @if (loading$ | async) {\n      <mat-spinner [color]="appearance?.color" strokeWidth="1" diameter="20"></mat-spinner>\n    }\n    @if (hierarchies()?.length > 1) {\n      <button mat-icon-button class="ngm-actionable-opacity"\n        [matMenuTriggerFor]="hierarchiesMenu"\n        #mt="matMenuTrigger"\n        [class.active]="mt.menuOpen"\n        (click)="$event.stopPropagation();$event.preventDefault();">\n        <mat-icon fontSet="material-icons-outlined">account_tree</mat-icon>\n      </button>\n    }\n\n    <button mat-icon-button type="button" [disabled]="disabled" class="ngm-smart-filter__help ngm-actionable-opacity"\n      (click)="$event.stopPropagation();$event.preventDefault();openValueHelp($event)"\n    >\n      <mat-icon>help_outline</mat-icon>\n    </button>\n  </div>\n</ngm-tree-select>\n\n<mat-radio-group [(ngModel)]="hierarchy">\n  <mat-menu #hierarchiesMenu="matMenu" class="ngm-radio-menu">\n    @for (property of hierarchies(); track property.name) {\n      <button mat-menu-item disableRipple\n        (click)="$event.stopPropagation();">\n        <mat-radio-button class="flex-1" [value]="property.name">\n          <ngm-property class="flex-1" hiddenIcon [property]="property" [displayBehaviour]="DisplayBehaviour.auto" />\n        </mat-radio-button>\n      </button>\n    }\n  </mat-menu>\n</mat-radio-group>\n',providers:[smart_filter_service.o,{provide:fesm2022_forms.JU,multi:!0,useExisting:(0,core.forwardRef)((()=>NgmMemberTreeSelectComponent))}],imports:[common.CommonModule,fesm2022_forms.u5,progress_spinner.Cq,menu.Tx,icon.Ps,fesm2022_radio.Fk,fesm2022_button.ot,common_module.N,core_module.A],styles:[tree_select_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[])],NgmMemberTreeSelectComponent)},"./packages/angular/controls/value-help/value-help.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{v:()=>NgmValueHelpComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _NgmValueHelpComponent,value_help_componentngResource=__webpack_require__("./packages/angular/controls/value-help/value-help.component.scss?ngResource"),value_help_componentngResource_default=__webpack_require__.n(value_help_componentngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),fesm2022_button=__webpack_require__("./node_modules/@angular/material/fesm2022/button.mjs"),dialog=__webpack_require__("./node_modules/@angular/material/fesm2022/dialog.mjs"),divider=__webpack_require__("./node_modules/@angular/material/fesm2022/divider.mjs"),form_field=__webpack_require__("./node_modules/@angular/material/fesm2022/form-field.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),list=__webpack_require__("./node_modules/@angular/material/fesm2022/list.mjs"),fesm2022_select=__webpack_require__("./node_modules/@angular/material/fesm2022/select.mjs"),slide_toggle=__webpack_require__("./node_modules/@angular/material/fesm2022/slide-toggle.mjs"),common_module=__webpack_require__("./packages/angular/common/common.module.ts"),core_service=__webpack_require__("./packages/angular/core/core.service.ts"),displayDensity=__webpack_require__("./packages/angular/core/directives/displayDensity.ts"),core_module=__webpack_require__("./packages/angular/core/core.module.ts"),src=__webpack_require__("./packages/core/src/index.ts"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/dist/fesm2022/ngx-translate-core.mjs"),merge=__webpack_require__("./node_modules/lodash-es/merge.js"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),switchMap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),member_list_component=__webpack_require__("./packages/angular/controls/member-list/member-list.component.ts"),member_tree_component=__webpack_require__("./packages/angular/controls/member-tree/member-tree.component.ts");let NgmValueHelpComponent=((_NgmValueHelpComponent=class NgmValueHelpComponent{get dataSettings(){return this.dataSettings$()}set dataSettings(value){this.dataSettings$.set(value)}get dimension(){return this._dimension()}set dimension(value){this._dimension.set(value)}get slicerModel(){return this.slicer}set slicerModel(value){this.slicer.members=value.members}get showAllMember(){return this.options?.showAllMember}set showAllMember(value){this.options={...this.options??{},showAllMember:value}}get onlyLeaves(){return this.options?.onlyLeaves}set onlyLeaves(value){this.options={...this.options??{},onlyLeaves:value}}get excludeSelected(){return this.slicer.exclude}set excludeSelected(value){this.slicer={...this.slicer,exclude:value}}get selectionType(){return this.options?.selectionType}set selectionType(value){this.options={...this.options??{},selectionType:value}}get treeSelectionMode(){return this.options?.treeSelectionMode}set treeSelectionMode(value){this.options={...this.options??{},treeSelectionMode:value}}get selectedMembers(){return this.slicer?.members}constructor(dialogRef,data){this.dialogRef=dialogRef,this.data=data,this.DISPLAY_BEHAVIOUR=src.CXV,this.FilterSelectionType=src.ucB,this.TreeSelectionMode=src.OrP,this.PresentationEnum=src.CEQ,this.dsCoreService=(0,core.inject)(core_service.q,{optional:!0}),this.dataSettings$=(0,core.signal)(null),this._dimension=(0,core.signal)(null),this.options={stickyHeader:!0},this.appearance={displayDensity:displayDensity.A.cosy,appearance:"standard"},this.slicer={},this.expandAvailables=!1,this.displayBehaviour=(0,core.computed)((()=>this._dimension()?.displayBehaviour??src.CXV.auto)),this.hierarchy=(0,core.computed)((()=>this._dimension()?.hierarchy||this._dimension()?.dimension)),this.entityType=(0,rxjs_interop.O4)((0,rxjs_interop.Dx)(this.dataSettings$).pipe((0,filter.h)((dataSettings=>!!dataSettings?.dataSource&&!!dataSettings?.entitySet)),(0,switchMap.w)((dataSettings=>this.dsCoreService.selectEntitySet(dataSettings.dataSource,dataSettings.entitySet))),(0,map.U)((entitySet=>entitySet?.entityType)))),this.hierarchies=(0,core.computed)((()=>{const entityType=this.entityType(),dimension=this._dimension();if(entityType&&dimension){const hierarchies=(0,src.ZBB)(entityType,dimension)?.hierarchies;return hierarchies?.length&&(this.presentation=this.presentation??src.CEQ.Hierarchy),hierarchies}return[]})),data?.dsCoreService&&(this.dsCoreService=data.dsCoreService)}ngOnInit(){this.data&&(this.dataSettings=this.data.dataSettings,this.dimension=this.data.dimension,this.data.options&&(this.options=(0,merge.Z)(this.options,this.data.options)),this.slicer={...this.data.slicer??{}})}setDisplayBehaviour(value){this._dimension.update((state=>({...state,displayBehaviour:value})))}setHierarchy(hierarchy){this._dimension.update((state=>({...state,hierarchy})))}deleteMember(i){const members=[...this.slicer.members];members.splice(i,1),this.slicer={...this.slicer,members}}clearSelection(){this.slicer={...this.slicer,members:[]}}close(){this.dialogRef.close({...this.slicer,dimension:{...this.dimension}})}}).ctorParameters=()=>[{type:dialog.so,decorators:[{type:core.Optional}]},{type:void 0,decorators:[{type:core.Optional},{type:core.Inject,args:[dialog.WI]}]}],_NgmValueHelpComponent.propDecorators={dataSettings:[{type:core.Input}],dimension:[{type:core.Input}],options:[{type:core.Input}],appearance:[{type:core.Input}]},_NgmValueHelpComponent);NgmValueHelpComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-value-help",template:'<div mat-dialog-title cdkDrag cdkDragRootElement=".cdk-overlay-pane" cdkDragHandle>\n    {{ \'Ngm.Controls.ValueHelp.Title\' | translate: {Default: \'Set Filters for \' + dimension?.dimension, value: dimension?.dimension} }}\n</div>\n\n<div class="flex px-4">\n    <div class="ngm-value-help__available-members">\n        <div class="ngm-value-help__available">\n            <div class="sub-title">\n                {{ \'Ngm.Controls.ValueHelp.AvailableMembers\' | translate: {Default: "Available Members"} }}\n                <button mat-icon-button (click)="expandAvailables=!expandAvailables">\n                    <mat-icon *ngIf="expandAvailables">keyboard_arrow_up</mat-icon>\n                    <mat-icon *ngIf="!expandAvailables">keyboard_arrow_down</mat-icon>\n                </button>\n            </div>\n\n            <div [ngStyle]="{height: expandAvailables ? \'120px\' : \'0\' }" class="ngm-value-help__options flex flex-col justify-start items-start gap-2">\n\n                <div class="flex flex-wrap justify-start items-center gap-2">\n                    <mat-form-field appearance="fill">\n                        <mat-label>\n                            {{ \'Ngm.Controls.ValueHelp.DisplayBehaviour\' | translate: {Default: "Display Behaviour"} }}\n                        </mat-label>\n                        <mat-select [ngModel]="displayBehaviour()" (ngModelChange)="setDisplayBehaviour($event)">\n                            <mat-option [value]="DISPLAY_BEHAVIOUR.descriptionOnly">\n                                {{ \'Ngm.Common.DisplayBehaviour_Description\' | translate: {Default: "Description"} }}\n                            </mat-option>\n                            <mat-option [value]="DISPLAY_BEHAVIOUR.descriptionAndId">\n                                {{ \'Ngm.Common.DisplayBehaviour_DescriptionID\' | translate: {Default: "Description ID"} }}\n                            </mat-option>\n                            <mat-option [value]="DISPLAY_BEHAVIOUR.idAndDescription">\n                                {{ \'Ngm.Common.DisplayBehaviour_IDDescription\' | translate: {Default: "ID Description"} }}\n                            </mat-option>\n                            <mat-option [value]="DISPLAY_BEHAVIOUR.idOnly">\n                                {{ \'Ngm.Common.DisplayBehaviour_ID\' | translate: {Default: "ID"} }}\n                            </mat-option>\n                            \x3c!-- null can\'t be selected in mat-select, so use \'\' as default value --\x3e\n                            <mat-option [value]="\'\'">\n                                {{ \'Ngm.Common.DisplayBehaviour_Auto\' | translate: {Default: "Auto"} }}\n                            </mat-option>\n                          </mat-select>\n                    </mat-form-field>\n    \n                    <mat-form-field appearance="fill">\n                        <mat-label>\n                            {{ \'Ngm.Controls.ValueHelp.Hierarchy\' | translate: {Default: "Hierarchy"} }}\n                        </mat-label>\n                        <mat-select [ngModel]="hierarchy()" (ngModelChange)="setHierarchy($event)">\n                          @for (hierarchy of hierarchies(); track hierarchy.name) {\n                            <mat-option [value]="hierarchy.name">{{hierarchy.caption}}</mat-option>\n                          }\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n\n                <div class="flex flex-wrap justify-start items-center gap-2 mx-2">\n                    \x3c!-- <mat-slide-toggle>\n                        {{ \'Ngm.Controls.ValueHelp.ShowUnbookedMembers\' | translate: {Default: "Show Unbooked"} }}\n                    </mat-slide-toggle> --\x3e\n                    <mat-slide-toggle [(ngModel)]="showAllMember">\n                        {{ \'Ngm.Controls.ValueHelp.ShowAllMember\' | translate: {Default: "Show \'All\' Member"} }}\n                    </mat-slide-toggle>\n                    <mat-slide-toggle [(ngModel)]="onlyLeaves">\n                        {{ \'Ngm.Controls.ValueHelp.ShowOnlyLeaves\' | translate: {Default: "Only Leaves"} }}\n                    </mat-slide-toggle>\n                    <mat-slide-toggle [(ngModel)]="excludeSelected">\n                        {{ \'Ngm.Controls.ValueHelp.ExcludeSelectedMembers\' | translate: {Default: "Exclude Selected"} }}\n                    </mat-slide-toggle>\n                </div>\n\n            </div>\n\n        </div>\n        <mat-divider></mat-divider>\n\n        <div class="ngm-value-help__members pt-2 flex flex-col">\n            <ngm-member-list *ngIf="presentation !== PresentationEnum.Hierarchy" class="w-full flex-1" cdkFocusInitial\n                [displayDensity]="appearance?.displayDensity"\n                [appearance]="appearance"\n                [dataSettings]="dataSettings"\n                [dimension]="dimension"\n                [options]="options"\n                [(ngModel)]="slicerModel"\n            ></ngm-member-list>\n\n            <ngm-member-tree *ngIf="presentation === PresentationEnum.Hierarchy" class="w-full flex-1" cdkFocusInitial\n                [displayDensity]="appearance?.displayDensity"\n                [appearance]="appearance"\n                [dataSettings]="dataSettings"\n                [dimension]="dimension"\n                [options]="options"\n                [(ngModel)]="slicerModel"\n            ></ngm-member-tree>\n        </div>\n    </div>\n\n    <mat-divider [vertical]="true"></mat-divider>\n\n    <div class="ngm-value-help__selected">\n        <div class="ngm-value-help__selected-members flex flex-col gap-2">\n            <div class="sub-title">\n                {{ \'Ngm.Controls.ValueHelp.SelectedMembers\' | translate: {Default: "Selected Members"} }}\n            </div>\n\n            <div class="ngm-value-help__selected-members-list" displayDensity="compact">\n                <mat-list class="ngm-list">\n                  @for (member of selectedMembers; track member.key; let i = $index) {\n                    <mat-list-item class="group">\n                        <div class="flex items-center overflow-hidden">\n                            <ngm-display-behaviour class="flex-1 overflow-hidden"\n                                [displayBehaviour]="displayBehaviour()"\n                                [option]="member"\n                                [excludeSelected]="excludeSelected">\n                            </ngm-display-behaviour>\n                            <mat-icon class="cursor-pointer shrink-0 opacity-0 group-hover:opacity-100" color="warn"\n                                (click)="deleteMember(i)">remove_circle_outline</mat-icon>\n                        </div>\n                        <mat-divider></mat-divider>\n                    </mat-list-item>\n                  }\n                </mat-list>\n            </div>\n            \n            <button mat-button color="accent" (click)="clearSelection()">\n                {{ \'Ngm.Controls.ValueHelp.ClearSelection\' | translate: {Default: "Clear Selection"} }}\n            </button>\n        </div>\n\n        <div class="ngm-value-help__settings grid grid-cols-1 md:grid-cols-2 gap-2">\n            <mat-form-field class="col-span-1" appearance="fill">\n                <mat-label>\n                    {{ \'Ngm.Controls.ValueHelp.SelectionType\' | translate: {Default: "Selection Type"} }}\n                </mat-label>\n                <mat-select [(ngModel)]="selectionType">\n                  <mat-option [value]="FilterSelectionType.Single">\n                    {{ \'Ngm.Common.SelectionType_Single\' | translate: {Default: "Single"} }}\n                  </mat-option>\n                  <mat-option [value]="FilterSelectionType.Multiple">\n                    {{ \'Ngm.Common.SelectionType_Multiple\' | translate: {Default: "Multiple"} }}\n                  </mat-option>\n                </mat-select>\n            </mat-form-field>\n\n            <mat-form-field class="col-span-1" appearance="fill">\n                <mat-label>\n                    {{ \'Ngm.Controls.ValueHelp.Presentation\' | translate: {Default: "Presentation"} }}\n                </mat-label>\n                <mat-select [(ngModel)]="presentation">\n                    <mat-option [value]="PresentationEnum.Flat">\n                        {{ \'Ngm.Common.Presentation_Flat\' | translate: {Default: "Flat"} }}\n                    </mat-option>\n                    <mat-option [value]="PresentationEnum.Hierarchy">\n                        {{ \'Ngm.Common.Presentation_Hierarchy\' | translate: {Default: "Hierarchy"} }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n\n            <mat-form-field *ngIf="presentation === PresentationEnum.Hierarchy && selectionType === FilterSelectionType.Multiple"\n                class="col-span-2"\n                appearance="fill"\n                >\n                <mat-label>\n                    {{ \'Ngm.Controls.ValueHelp.HierarchySelectionMode\' | translate: {Default: "Hierarchy Selection Mode"} }}\n                </mat-label>\n                <mat-select [(ngModel)]="treeSelectionMode">\n                    <mat-option [value]="TreeSelectionMode.Individual">\n                        {{ \'Ngm.Common.HierarchySelectionMode_Individual\' | translate: {Default: "Individual"} }}\n                    </mat-option>\n                    <mat-option [value]="TreeSelectionMode.SelfDescendants">\n                        {{ \'Ngm.Common.HierarchySelectionMode_SelfDescendants\' | translate: {Default: "Self & Descendants"} }}\n                    </mat-option>\n                    <mat-option [value]="TreeSelectionMode.DescendantsOnly">\n                        {{ \'Ngm.Common.HierarchySelectionMode_DescendantsOnly\' | translate: {Default: "Descendants Only"} }}\n                    </mat-option>\n                    <mat-option [value]="TreeSelectionMode.SelfChildren">\n                        {{ \'Ngm.Common.HierarchySelectionMode_SelfChildren\' | translate: {Default: "Self & Children"} }}\n                    </mat-option>\n                    <mat-option [value]="TreeSelectionMode.ChildrenOnly">\n                        {{ \'Ngm.Common.HierarchySelectionMode_ChildrenOnly\' | translate: {Default: "Children Only"} }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n        </div>\n    </div>\n</div>\n\n<div matDialogActions align="end" class="flex justify-end">\n    <div ngmButtonGroup>\n        <button mat-button mat-dialog-close>\n            {{ \'Ngm.Common.Cancel\' | translate: {Default: "Cancel"} }}\n          </button>\n          <button mat-raised-button color="accent" (click)="close()">\n            {{ \'Ngm.Common.Apply\' | translate: {Default: "Apply"} }}\n          </button>\n    </div>\n</div>\n',host:{class:"ngm-value-help"},imports:[common.CommonModule,fesm2022_forms.u5,ngx_translate_core.aw,dialog.Is,icon.Ps,slide_toggle.rP,divider.t,list.ie,form_field.lN,fesm2022_select.LD,fesm2022_button.ot,common_module.N,core_module.A,member_list_component.N,member_tree_component.i],styles:[value_help_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[dialog.so,Object])],NgmValueHelpComponent)},"./packages/angular/mock/agent-mock.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ch:()=>MockAgent,fJ:()=>CUBE_SALES_ORDER_NAME,nH:()=>CUBE_SALES_ORDER});var tslib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_metad_ocap_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/core/src/index.ts"),_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@ngneat/falso/index.esm.js"),rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js");const columns=[{name:"OrderId",label:"订单号",type:"string"},{name:"product",label:"产品",type:"string"},{name:"productCategory",label:"产品类别",type:"string"},{name:"Department",label:"部门",type:"string"},{name:"sales",label:"销售额",type:"number"},{name:"quantity",label:"销售量",type:"number"}],SalesOrder={name:"SalesOrder",label:"销售订单",columns},SalesOrder10s={name:"SalesOrder10s",label:"销售订单10秒",columns},SalesOrder3s={name:"SalesOrder3s",label:"销售订单3秒",columns},CUBE_SALES_ORDER_NAME="SalesOrder",CUBE_SALES_ORDER={name:CUBE_SALES_ORDER_NAME,caption:"销售订单",visible:!0,tables:[{name:"sales_order"}],dimensions:[{name:"Product",caption:"产品",hierarchies:[{name:"",caption:"产品",levels:[{name:"Product",column:"product",captionColumn:"ProductName"}]}]},{name:"Department",caption:"部门",hierarchies:[{name:"",levels:[{name:"Department",column:"department",captionColumn:"DepartmentName"}]}]}],measures:[{name:"Sales",column:"sales",caption:"销售额"},{name:"Cost",column:"cost",caption:"成本"}]};let MockAgent=class MockAgent{constructor(){this.type=_metad_ocap_core__WEBPACK_IMPORTED_MODULE_0__.buO.Browser,this.error$=new rxjs__WEBPACK_IMPORTED_MODULE_1__.x}selectStatus(){return(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(_metad_ocap_core__WEBPACK_IMPORTED_MODULE_0__.dJT.ONLINE)}selectError(){return this.error$}error(err){this.error$.next(err)}request(dataSource,options){return new Promise(((resolve,reject)=>{if("get"===options.method){if("schema"===options.url)switch(options.table){case SalesOrder10s.name:return resolve([{schema:"default",tables:[SalesOrder10s]}]);case SalesOrder3s.name:return resolve([{schema:"default",tables:[SalesOrder3s]}]);case SalesOrder.name:return resolve([{schema:"default",tables:[SalesOrder]}]);case"Empty":return resolve([{schema:"default",tables:[{name:"Empty",columns:[]}]}]);default:return'SELECT * FROM "SalesOrder"'===options.statement?resolve([{schema:"default",tables:[SalesOrder]}]):resolve([{schema:"default",tables:[{name:"Inventory",label:"库存",columns:[{name:"product",label:"产品",type:"string"},{name:"productCategory",label:"产品类别",type:"string"},{name:"sales",label:"销售额",type:"number"},{name:"quantity",label:"销售量",type:"number"}]}]}])}}else if("post"===options.method&&"query"===options.url){const results=[];if(options.body?.statement?.includes("AS `memberKey`")){const data=[];return(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.mJl)({length:3}).forEach((product=>{data.push({memberKey:product,memberCaption:product}),(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.mJl)({length:3}).filter((product2=>!data.find((item=>item.memberKey===product2)))).forEach((product2=>{data.push({memberKey:product2,memberCaption:product2,parentKey:product}),(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.mJl)({length:5}).filter((product=>!data.find((item=>item.memberKey===product)))).forEach((product3=>{data.push({memberKey:product3,memberCaption:product3,parentKey:product2})}))}))})),resolve({data,columns:[{name:"memberKey",label:"成员 Key",type:"string"},{name:"parentKey",label:"父级 Key",type:"string"}]})}if(options.body?.statement?.includes('"Department" AS "Department"')){let departmentCode=0;return(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.T1i)({length:5}).forEach((name=>{departmentCode++;const department1=departmentCode;results.push({Department:department1,DepartmentName:name,quantity:(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.Qyw)()}),(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.T1i)({length:5}).forEach((name=>{departmentCode++;const department2=departmentCode;results.push({Department:department2,DepartmentName:name,DepartmentParent:department1,quantity:(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.Qyw)()}),(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.T1i)({length:3}).forEach((name=>{departmentCode++;const department3=departmentCode;results.push({Department:department3,DepartmentName:name,DepartmentParent:department2,quantity:(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.Qyw)()})}))}))})),resolve({data:results,columns:[{name:"Department",label:"部门",type:"string"},{name:"DepartmentName",label:"部门",type:"string"},{name:"DepartmentParent",label:"上级部门",type:"string"}]})}return(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.ALu)({length:3}).forEach((productCategory=>{const DepartmentParent=(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.T1i)();(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.mJl)({length:5}).forEach((product=>{results.push({OrderId:(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.s8S)(),"[Product]":(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.s8S)(),"[Product].[MEMBER_CAPTION]":product,productCategory,Department:(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.T1i)(),DepartmentParent,Sales:(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.Qyw)(),quantity:(0,_ngneat_falso__WEBPACK_IMPORTED_MODULE_3__.Qyw)()})}))})),options.body?.statement?.includes(SalesOrder10s.name)?void setTimeout((()=>{resolve({data:results,columns})}),1e4):options.body?.statement?.includes(SalesOrder3s.name)?void setTimeout((()=>{resolve({data:results,columns})}),3e3):options.body?.statement?.includes("empty_")?resolve({data:[],columns:[]}):void setTimeout((()=>{resolve({data:results,columns:[{name:"OrderId",label:"订单号",type:"string"},{name:"[Product]",label:"产品",type:"string"},{name:"productCategory",label:"产品类别",type:"string"},{name:"[Department]",label:"部门",type:"string"},{name:"[DepartmentParent]",label:"上级部门",type:"string"}]})}),1e3)}resolve({})}))}};MockAgent=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.Injectable)()],MockAgent)},"?d4c0":()=>{}}]);