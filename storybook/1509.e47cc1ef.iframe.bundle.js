(self.webpackChunkocap=self.webpackChunkocap||[]).push([[1509],{"./packages/angular/common/search/search.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{K:()=>NgmSearchComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _class,search_componentngResource=__webpack_require__("./packages/angular/common/search/search.component.scss?ngResource"),search_componentngResource_default=__webpack_require__.n(search_componentngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),input=__webpack_require__("./node_modules/@angular/material/fesm2022/input.mjs"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/fesm2020/ngx-translate-core.mjs");let NgmSearchComponent=((_class=class NgmSearchComponent{writeValue(obj){this._value=obj}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){this.disabled=isDisabled,isDisabled?this.formControl?.disable({emitEvent:!1}):this.formControl?.enable({emitEvent:!1})}onValueChange(value){this.formControl?.setValue(value),this.onChange(value)}}).propDecorators={formControl:[{type:core.Input}],disabled:[{type:core.Input}]},_class);NgmSearchComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,imports:[common.CommonModule,fesm2022_forms.u5,fesm2022_forms.UX,ngx_translate_core.aw,input.c],selector:"ngm-search",template:'<span role="img" aria-label="search" class="ngm-search__icon absolute inset-y-0 left-0 flex items-center pointer-events-none">\n  <svg viewBox="64 64 896 896" focusable="false" class="" data-icon="search" width="1em" height="1em" fill="currentColor" aria-hidden="true">\n    <path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path>\n  </svg>\n</span>\n<input matInput class="ngm-search__input outline-none bg-transparent"\n       placeholder="{{ \'Ngm.Common.Search\' | translate: {Default: \'Search\'} }}" type="text"\n       [(ngModel)]="_value" [disabled]="disabled"\n       (ngModelChange)="onValueChange($event)"\n       />\n',providers:[{provide:fesm2022_forms.JU,multi:!0,useExisting:(0,core.forwardRef)((()=>NgmSearchComponent))}],host:{class:"ngm-search"},styles:[search_componentngResource_default()]})],NgmSearchComponent)},"./packages/angular/copilot/chat/chat.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>NgmCopilotChatComponent});var asyncToGenerator=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),classPrivateFieldInitSpec=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js"),classPrivateFieldSet=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldSet.js"),classPrivateFieldGet=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet.js"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var chat_componentngResource=__webpack_require__("./packages/angular/copilot/chat/chat.component.scss?ngResource"),chat_componentngResource_default=__webpack_require__.n(chat_componentngResource),clipboard=__webpack_require__("./node_modules/@angular/cdk/fesm2022/clipboard.mjs"),text_field=__webpack_require__("./node_modules/@angular/cdk/fesm2022/text-field.mjs"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),autocomplete=__webpack_require__("./node_modules/@angular/material/fesm2022/autocomplete.mjs"),fesm2022_button=__webpack_require__("./node_modules/@angular/material/fesm2022/button.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),list=__webpack_require__("./node_modules/@angular/material/fesm2022/list.mjs"),progress_bar=__webpack_require__("./node_modules/@angular/material/fesm2022/progress-bar.mjs"),slider=__webpack_require__("./node_modules/@angular/material/fesm2022/slider.mjs"),tooltip=__webpack_require__("./node_modules/@angular/material/fesm2022/tooltip.mjs"),input=__webpack_require__("./node_modules/@angular/material/fesm2022/input.mjs"),router=__webpack_require__("./node_modules/@angular/router/fesm2022/router.mjs"),src=__webpack_require__("./packages/copilot/src/index.ts"),search_component=__webpack_require__("./packages/angular/common/search/search.component.ts");var _translateService,_tranSub,_class2,table_componentngResource=__webpack_require__("./packages/angular/common/table/table/table.component.scss?ngResource"),table_componentngResource_default=__webpack_require__.n(table_componentngResource),coercion=__webpack_require__("./node_modules/@angular/cdk/fesm2022/coercion.mjs"),collections=__webpack_require__("./node_modules/@angular/cdk/fesm2022/collections.mjs"),drag_drop=__webpack_require__("./node_modules/@angular/cdk/fesm2022/drag-drop.mjs"),fesm2022_checkbox=__webpack_require__("./node_modules/@angular/material/fesm2022/checkbox.mjs"),paginator=__webpack_require__("./node_modules/@angular/material/fesm2022/paginator.mjs"),sort=__webpack_require__("./node_modules/@angular/material/fesm2022/sort.mjs"),table=__webpack_require__("./node_modules/@angular/material/fesm2022/table.mjs"),displayDensity=__webpack_require__("./packages/angular/core/directives/displayDensity.ts"),core_module=__webpack_require__("./packages/angular/core/core.module.ts"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/fesm2020/ngx-translate-core.mjs"),get=__webpack_require__("./node_modules/lodash-es/get.js"),Subject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js");let MyCustomPaginatorIntl=(_translateService=new WeakMap,_tranSub=new WeakMap,class MyCustomPaginatorIntl{constructor(){(0,classPrivateFieldInitSpec.Z)(this,_translateService,{writable:!0,value:void 0}),(0,classPrivateFieldInitSpec.Z)(this,_tranSub,{writable:!0,value:void 0}),(0,classPrivateFieldSet.Z)(this,_translateService,(0,core.inject)(ngx_translate_core.sK)),this.changes=new Subject.x,(0,classPrivateFieldSet.Z)(this,_tranSub,(0,classPrivateFieldGet.Z)(this,_translateService).stream("COMPONENTS.Table",{Default:{firstPageLabel:"First page",itemsPerPageLabel:"Items per page:",lastPageLabel:"Last page",nextPageLabel:"Next page",previousPageLabel:"Previous page",rangeLabel0:"Page 1 of 1",pageLabel:"Page",ofLabel:"of"}}).pipe((0,rxjs_interop.sL)()).subscribe((table=>{table&&(this.firstPageLabel=table.firstPageLabel,this.itemsPerPageLabel=table.itemsPerPageLabel,this.lastPageLabel=table.lastPageLabel,this.nextPageLabel=table.nextPageLabel,this.previousPageLabel=table.previousPageLabel,this.rangeLabel0=table.rangeLabel0,this.pageLabel=table.pageLabel,this.ofLabel=table.ofLabel)}))),this.firstPageLabel="First page",this.itemsPerPageLabel="Items per page:",this.lastPageLabel="Last page",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.rangeLabel0="Page 1 of 1",this.pageLabel="Page",this.ofLabel="of"}getRangeLabel(page,pageSize,length){if(0===length)return this.rangeLabel0;const amountPages=Math.ceil(length/pageSize);return`${this.pageLabel} ${page+1} ${this.ofLabel} ${amountPages}`}});MyCustomPaginatorIntl=(0,tslib_es6.gn)([(0,core.Injectable)()],MyCustomPaginatorIntl);let NgmTableComponent=((_class2=class NgmTableComponent{get data(){return this._data}set data(value){this._data=value,this.dataSource.data=value??[]}get paging(){return this._paging}set paging(value){this._paging=(0,coercion.Ig)(value)}get grid(){return this._grid}set grid(value){this._grid=(0,coercion.Ig)(value)}get selectable(){return this._selectable}set selectable(value){this._selectable=(0,coercion.Ig)(value)}constructor(){this.pageSizeOptions=[20,50,100],this._grid=!1,this._selectable=!1,this.displayDensity=displayDensity.A.compact,this.rowSelectionChanging=new core.EventEmitter,this.displayedColumns=[],this.dataSource=new table.by,this.searchControl=new fesm2022_forms.NI(""),this.searchingColumn="",this.selection=new collections.Ov(!0,[]),this._searchValueSub=this.searchControl.valueChanges.subscribe((value=>{this.dataSource.filter=value})),this.selection.changed.subscribe((()=>this.rowSelectionChanging.emit(this.selection.selected)))}ngOnChanges({columns}){columns?.currentValue&&(this.displayedColumns=columns.currentValue.map((({name})=>name)),this.selectable&&this.displayedColumns.unshift("select"))}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.sort?.sortChange.subscribe((sort=>{this.paginator.pageIndex=0})),this.dataSource.filterPredicate=(data,filter)=>{const dataStr=(""+data[this.searchingColumn]).toLowerCase(),transformedFilter=filter.trim().toLowerCase();return-1!=dataStr.indexOf(transformedFilter)}}_context(data,column){return{...data,$implicit:(0,get.Z)(data,column.name)}}getValue(row,name){return(0,get.Z)(row,name)}escapeSearching(event){"Escape"===event.key&&(this.searchingColumn="",this.searchControl.setValue(""))}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(row){return row?`${this.selection.isSelected(row)?"deselect":"select"} row ${row.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}}).ctorParameters=()=>[],_class2.propDecorators={columns:[{type:core.Input}],data:[{type:core.Input}],paging:[{type:core.Input}],pageSizeOptions:[{type:core.Input}],grid:[{type:core.Input}],selectable:[{type:core.Input}],displayDensity:[{type:core.Input}],rowSelectionChanging:[{type:core.Output}],paginator:[{type:core.ViewChild,args:[paginator.NW]}],sort:[{type:core.ViewChild,args:[sort.YE]}]},_class2);NgmTableComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-table",template:'<div class="ngm-table__container flex-1 h-full flex flex-col overflow-auto">\n    <table mat-table [dataSource]="dataSource" matSort\n      class="min-w-full" [ngClass]="{grid: grid}"\n      [displayDensity]="displayDensity"\n      >\n\n      \x3c!-- Checkbox Column --\x3e\n      <ng-container matColumnDef="select">\n        <th mat-header-cell *matHeaderCellDef>\n          <mat-checkbox class="mx-2"\n            (change)="$event ? toggleAllRows() : null"\n            [checked]="selection.hasValue() && isAllSelected()"\n            [indeterminate]="selection.hasValue() && !isAllSelected()"\n            [aria-label]="checkboxLabel()">\n          </mat-checkbox>\n        </th>\n        <td mat-cell *matCellDef="let row">\n          <mat-checkbox class="mx-2"\n            (click)="$event.stopPropagation()"\n            (change)="$event ? selection.toggle(row) : null"\n            [checked]="selection.isSelected(row)"\n            [aria-label]="checkboxLabel(row)">\n          </mat-checkbox>\n        </td>\n      </ng-container>\n\n        \x3c!-- Columns --\x3e\n        <ng-container [matColumnDef]="column.name" *ngFor="let column of columns">\n          <th mat-header-cell *matHeaderCellDef mat-sort-header [width]="column.width">\n            <div class="ngm-header-cell flex-1 flex justify-start items-center whitespace-nowrap">\n              {{column.caption || column.name}}\n\n              <div class="searchable flex-1 flex justify-between items-center" [class.searching]="searchingColumn===column.name">\n                <input matInput placeholder="{{ \'PAC.KEY_WORDS.SEARCH\' | translate: {Default: \'Search\'} }}" type="text" class="flex-1 text-left"\n                  value="" [formControl]="searchControl"\n                  (click)="$event.stopPropagation();"\n                  (keyup)="escapeSearching($event)">\n                <span role="img" aria-label="search" class="searchable-icon"\n                  (click)="$event.stopPropagation();searchingColumn=searchingColumn===column.name?null:column.name">\n                  <svg viewBox="64 64 896 896" focusable="false" class="" data-icon="search" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path></svg>\n                </span>\n              </div>\n              \n            </div>\n          </th>\n          <td mat-cell *matCellDef="let data" >\n            <ng-container *ngIf="column.cellTemplate">\n              <ng-container *ngTemplateOutlet="column.cellTemplate; context: _context(data, column)"></ng-container>\n            </ng-container>\n            <ng-container *ngIf="!column.cellTemplate">\n              {{ column.pipe ? column.pipe(getValue(data, column.name)) : getValue(data, column.name) }}\n            </ng-container>\n          </td>\n        </ng-container>\n      \n        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky:true" class="bg-gray-50"></tr>\n        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>\n    </table>\n</div>\n\n<mat-paginator *ngIf="paging" class="ngm-density__compact" [pageSizeOptions]="pageSizeOptions" showFirstLastButtons></mat-paginator>\n',host:{class:"ngm-table"},imports:[common.CommonModule,drag_drop._t,fesm2022_forms.u5,fesm2022_forms.UX,fesm2022_checkbox.p9,table.p0,paginator.TU,icon.Ps,fesm2022_button.ot,sort.JX,input.c,ngx_translate_core.aw,core_module.A,search_component.K],styles:[table_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[])],NgmTableComponent);var _class,platform_browser=__webpack_require__("./node_modules/@angular/platform-browser/fesm2022/platform-browser.mjs");let NgmHighlightDirective=((_class=class NgmHighlightDirective{constructor(el,sanitizer){this.el=el,this.sanitizer=sanitizer,this.caseSensitive=!1,this.customClasses=""}ngOnChanges({content,searchTerm,caseSensitive}){this.el?.nativeElement&&(searchTerm||content||caseSensitive)&&this.updateContent()}updateContent(){const text=this.content||this.el.nativeElement.textContent;if(this.searchTerm){const regex=new RegExp(this.searchTerm,this.caseSensitive?"g":"gi"),newText=text.replace(regex,(match=>`<mark class="highlight ${this.customClasses}">${match}</mark>`)),sanitzed=this.sanitizer.sanitize(core.SecurityContext.HTML,newText);this._content=sanitzed}else this._content=text}}).ctorParameters=()=>[{type:core.ElementRef},{type:platform_browser.DomSanitizer}],_class.propDecorators={searchTerm:[{type:core.Input,args:["ngmHighlight"]}],content:[{type:core.Input}],caseSensitive:[{type:core.Input}],customClasses:[{type:core.Input}],_content:[{type:core.HostBinding,args:["innerHtml"]}]},_class);NgmHighlightDirective=(0,tslib_es6.gn)([(0,core.Directive)({standalone:!0,selector:"[ngmHighlight]"}),(0,tslib_es6.w6)("design:paramtypes",[core.ElementRef,platform_browser.DomSanitizer])],NgmHighlightDirective);var helpers=__webpack_require__("./packages/angular/core/helpers.ts"),ngx_markdown=__webpack_require__("./node_modules/ngx-markdown/fesm2022/ngx-markdown.mjs"),ngx_popperjs=__webpack_require__("./node_modules/ngx-popperjs/fesm2020/ngx-popperjs.mjs"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),combineLatest=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js"),startWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),delay=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/delay.js"),firstValueFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js"),scan=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/scan.js");var enable_component_class,enable_componentngResource=__webpack_require__("./packages/angular/copilot/enable/enable.component.scss?ngResource"),enable_componentngResource_default=__webpack_require__.n(enable_componentngResource);let CopilotEnableComponent=((enable_component_class=class CopilotEnableComponent{constructor(){this.copilotService=(0,core.inject)(src.yY),this.toConfig=new core.EventEmitter}get copilotConfig(){return this.copilotService.copilot}navigateToConfig(){this.toConfig.emit()}}).propDecorators={title:[{type:core.Input}],subTitle:[{type:core.Input}],toConfig:[{type:core.Output}]},enable_component_class);CopilotEnableComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-copilot-enable",template:'@if (!copilotConfig?.enabled || !copilotConfig?.apiKey) {\n<div class="w-full h-full flex-1 flex flex-col justify-center items-center gap-4 bg-gray-500/20 backdrop-blur-md group">\n    <div class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-rose-400 via-fuchsia-500 to-indigo-500 group-hover:ngm-background-animate">\n        {{ title }}\n    </div>\n    <div class="text-base font-bold text-transparent bg-clip-text bg-gradient-to-r from-rose-400 via-fuchsia-500 to-indigo-500 group-hover:ngm-background-animate">\n        {{ subTitle }}\n    </div>\n    \n    @if (copilotConfig?.enabled && !copilotConfig?.apiKey) {\n    <div class="text-red-400">\n        {{ \'Ngm.Copilot.ProvideOpenaiApiKey\' | translate: {Default: \'Please provide openai api key!\'} }}\n    </div>\n    }\n    \n    <button mat-stroked-button (click)="navigateToConfig()">\n        <div class="flex items-center">\n            {{ \'Ngm.Copilot.EnableCopilot\' | translate: {Default: \'Enable Copilot\'} }}\n            <mat-icon fontSet="material-icons-outlined" displayDensity="cosy">arrow_forward</mat-icon>\n        </div>\n    </button>\n</div>\n}\n',imports:[common.CommonModule,router.Bz,ngx_translate_core.aw,icon.Ps,fesm2022_button.ot,displayDensity.Z],host:{class:"ngm-copilot-enable"},styles:[enable_componentngResource_default()]})],CopilotEnableComponent);var token_component_class,engine_service=__webpack_require__("./packages/angular/copilot/services/engine.service.ts"),token_component=__webpack_require__("./packages/angular/copilot/token/token.component.ts.css?ngResource!=!./node_modules/@angular-devkit/build-angular/node_modules/@ngtools/webpack/src/loaders/inline-resource.js?data=CiAgICAgIDpob3N0IHsKICAgICAgfQogICAg!./packages/angular/copilot/token/token.component.ts"),token_component_default=__webpack_require__.n(token_component);let CopilotChatTokenComponent=((token_component_class=class CopilotChatTokenComponent{constructor(){this.characterLength=0}ngOnChanges({content}){content&&(this.characterLength=content.currentValue?.length)}}).propDecorators={content:[{type:core.Input}]},token_component_class);var avatar_component_class;CopilotChatTokenComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-copilot-token",template:'<span\n    class="bg-neutral-100 text-neutral-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-neutral-700 dark:text-neutral-300"\n    matTooltip="{{ \'PAC.Copilot.CharacterLength\' | translate: { Default: \'Character length\' } }}"\n  >\n    <span *ngIf="characterLength >= 4000" class="inline-block w-2 h-2 bg-yellow-400 rounded-full"></span>\n    <span *ngIf="characterLength < 4000" class="inline-block w-2 h-2 bg-gray-300 rounded-full"></span>\n    {{ characterLength }}\n  </span>',imports:[common.CommonModule,tooltip.AV,ngx_translate_core.aw],host:{class:"ngm-copilot-token"},styles:[token_component_default()]})],CopilotChatTokenComponent);let UserAvatarComponent=((avatar_component_class=class UserAvatarComponent{}).propDecorators={user:[{type:core.Input}]},avatar_component_class);UserAvatarComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,selector:"ngm-copilopt-user-avatar",template:'<img class="" [src]="user?.imageUrl || \'/assets/images/avatar-default.svg\'" alt="{{ user?.name }}" />',imports:[common.CommonModule]})],UserAvatarComponent);var chat_component_class,_copilotEngine,_conversations,_activatedPrompt,_suggestionsOpened,_clearCommand,dist=__webpack_require__("./node_modules/ai/dist/index.mjs"),inject_copilot_command=__webpack_require__("./packages/angular/copilot/hooks/inject-copilot-command.ts"),pick=__webpack_require__("./node_modules/lodash-es/pick.js");let NgmCopilotChatComponent=(_copilotEngine=new WeakMap,_conversations=new WeakMap,_activatedPrompt=new WeakMap,_suggestionsOpened=new WeakMap,_clearCommand=new WeakMap,chat_component_class=class NgmCopilotChatComponent{get copilotEngine(){return(0,classPrivateFieldGet.Z)(this,_copilotEngine)}set copilotEngine(value){(0,classPrivateFieldSet.Z)(this,_copilotEngine,value)}set systemPrompt(value){this._systemPrompt.set(value)}get conversations(){return this.copilotEngine?this.copilotEngine.conversations:(0,classPrivateFieldGet.Z)(this,_conversations).call(this)}get enabled(){return this.copilotService.enabled}get hasKey(){return this.copilotService.hasKey}get _placeholder(){return this.copilotEngine?.placeholder??this.placeholder}get aiOptions(){return this.copilotEngine?.aiOptions??this.openaiOptions}get useSystemPrompt(){return this.aiOptions.useSystemPrompt}set useSystemPrompt(value){this.copilotEngine?this.copilotEngine.aiOptions={...this.aiOptions,useSystemPrompt:value}:this.openaiOptions.useSystemPrompt=value}get model(){return this.aiOptions.model}set model(value){this.copilotEngine?this.copilotEngine.aiOptions={...this.aiOptions,model:value}:this.openaiOptions.model=value}get temperature(){return this.aiOptions.temperature}set temperature(value){this.copilotEngine?this.copilotEngine.aiOptions={...this.aiOptions,temperature:value}:this.openaiOptions.temperature=value}get n(){return this.aiOptions.n}set n(value){this.copilotEngine?this.copilotEngine.aiOptions={...this.aiOptions,n:value}:this.openaiOptions.n=value}get copilotEnabled(){return this.copilotService.enabled}constructor(){var _ref,_this=this;(0,classPrivateFieldInitSpec.Z)(this,_copilotEngine,{writable:!0,value:void 0}),(0,classPrivateFieldInitSpec.Z)(this,_conversations,{writable:!0,value:void 0}),(0,classPrivateFieldInitSpec.Z)(this,_activatedPrompt,{writable:!0,value:void 0}),(0,classPrivateFieldInitSpec.Z)(this,_suggestionsOpened,{writable:!0,value:void 0}),(0,classPrivateFieldInitSpec.Z)(this,_clearCommand,{writable:!0,value:void 0}),this.NgxPopperjsPlacements=ngx_popperjs.Mz,this.NgxPopperjsTriggers=ngx_popperjs.f3,this.CopilotChatMessageRoleEnum=src.eV,this.popperjsContentComponent=(0,core.inject)(ngx_popperjs.SL,{optional:!0}),this.translateService=(0,core.inject)(ngx_translate_core.sK),this._cdr=(0,core.inject)(core.ChangeDetectorRef),this.copilotService=(0,core.inject)(src.yY),(0,classPrivateFieldSet.Z)(this,_copilotEngine,(0,core.inject)(engine_service.S,{optional:!0})),this._systemPrompt=(0,core.signal)(null),(0,classPrivateFieldSet.Z)(this,_conversations,(0,core.signal)([])),this.copy=new core.EventEmitter,this.conversationsChange=new core.EventEmitter,this._mockConversations=[{id:(0,dist.x0)(),role:src.eV.User,content:"你好"},{id:(0,dist.x0)(),role:src.eV.Assistant,content:"你好！有什么我可以帮忙的吗？"},{id:(0,dist.x0)(),role:src.eV.User,content:"你是谁"},{id:(0,dist.x0)(),role:src.eV.Assistant,content:"我是ChatGPT，一个由OpenAI训练的自然语言处理模型。我可以回答各种问题并提供各种帮助。请问有什么我可以为您做的吗？"},{id:(0,dist.x0)(),role:src.eV.User,content:"假如你是我的 AI pair programmer"},{id:(0,dist.x0)(),role:src.eV.Assistant,content:"如果我是您的 AI pair programmer，那么我会与您合作编写代码，并提供技术支持和建议。我可以帮助您识别和纠正代码中的错误，优化代码性能，同时也可以为您提供实用的编程技巧和最佳实践。在与您的合作中，我将尽力提高我们的生产力和效率，并确保我们在团队合作中最大化我们的技能和资源。\n      然而，需要注意的是，我只是一个机器人，并不能像人类程序员一样创造独特的解决方案或应对具有挑战性的技术问题。我的工作方式是基于预设的算法和模型，因此在与我合作时，您可能需要提供更多的背景信息和指导，以确保我们的工作结果达到您的期望。"}],this.openaiOptions={model:"gpt-3.5-turbo",useSystemPrompt:!0},this.selectedModel=[this.aiOptions.model],this.promptControl=new fesm2022_forms.NI(""),this.prompt=(0,rxjs_interop.O4)(this.promptControl.valueChanges,{initialValue:""}),(0,classPrivateFieldSet.Z)(this,_activatedPrompt,(0,core.signal)("")),this.answering=(0,core.signal)(!1),this.historyQuestions=(0,core.signal)([]),this.historyIndex=(0,core.signal)(-1),this._models$=new BehaviorSubject.X([{id:"gpt-3.5-turbo",label:"gpt-3.5-turbo"},{id:"gpt-4",label:"gpt-4"},{id:"gpt-4-32k",label:"gpt-4-32k"}]),this.searchModel=new fesm2022_forms.NI(""),this.models=(0,rxjs_interop.O4)((0,combineLatest.a)([this._models$,this.searchModel.valueChanges.pipe((0,startWith.O)(""))]).pipe((0,map.U)((([_models,text])=>text?_models.filter((item=>item.label.includes(text))):_models))),{initialValue:[]}),this.commands=(0,core.computed)((()=>{if(this.copilotEngine?.commands){const commands=[];return this.copilotEngine.commands().forEach((command=>{command.examples?.length?command.examples.forEach((example=>{commands.push({...command,prompt:`/${command.name} ${example}`,example})})):commands.push({...command,prompt:`/${command.name} ${command.description}`})})),commands}return[]})),this.filteredCommands=(0,core.computed)((()=>{const text=this.prompt();return text?this.commands()?.filter((item=>item.prompt.includes(text)))??[]:[]})),this.lastConversation=(0,core.computed)((()=>{const lastMessages=[];let lastUserMessage=null;for(let i=(0,classPrivateFieldGet.Z)(this,_copilotEngine).conversations.length-1;i>=0&&!(0,classPrivateFieldGet.Z)(this,_copilotEngine).conversations[i].end;i--)(0,classPrivateFieldGet.Z)(this,_copilotEngine).conversations[i].role===src.eV.User?lastUserMessage?lastUserMessage.content=(0,classPrivateFieldGet.Z)(this,_copilotEngine).conversations[i].content+"\n"+lastUserMessage.content:lastUserMessage={role:src.eV.User,content:(0,classPrivateFieldGet.Z)(this,_copilotEngine).conversations[i].content}:(lastUserMessage&&(lastMessages.push(lastUserMessage),lastUserMessage=null),lastMessages.push((0,classPrivateFieldGet.Z)(this,_copilotEngine).conversations[i]));return lastUserMessage&&lastMessages.push(lastUserMessage),lastMessages.reverse()})),this.suggestionsOpened$=new BehaviorSubject.X(!1),(0,classPrivateFieldSet.Z)(this,_suggestionsOpened,(0,rxjs_interop.O4)(this.suggestionsOpened$.pipe((0,delay.g)(100)),{initialValue:!1})),(0,classPrivateFieldSet.Z)(this,_clearCommand,(0,inject_copilot_command.K)({name:"clear",description:"清空对话",examples:["清空对话"],implementation:(_ref=(0,asyncToGenerator.Z)((function*(){return _this.copilotEngine.clear(),{id:(0,dist.x0)(),role:src.eV.Assistant,content:"对话已清空"}})),function implementation(){return _ref.apply(this,arguments)})})),this._copilotSub=this.copilotService.copilot$.pipe((0,delay.g)(1e3),(0,rxjs_interop.sL)()).subscribe((()=>{this._cdr.detectChanges()})),(0,core.effect)((()=>{this.answering()?this.promptControl.disable():this.promptControl.enable()}),{allowSignalWrites:!0})}refreshModels(){this.copilotService.getModels().subscribe((res=>{this._models$.next(res.data.map((model=>({id:model.id,label:model.id}))))}))}changeSelectedModel(values){this.model=values[0]}askPredefinedPrompt(prompt){var _this2=this;return(0,asyncToGenerator.Z)((function*(){_this2.stopGenerating(),prompt=yield(0,firstValueFrom.z)(_this2.translateService.get("PAC.Copilot.Prompts."+prompt,{Default:prompt})),yield _this2.askCopilotStream(prompt,!0)}))()}askCopilotStream(prompt,newConversation){var _this3=this;return(0,asyncToGenerator.Z)((function*(){_this3.historyIndex.set(-1),_this3.historyQuestions.set([prompt,..._this3.historyQuestions()]),_this3.promptControl.setValue("");const lastConversation=_this3.lastConversation(),assistant={id:(0,dist.x0)(),role:src.eV.Assistant,content:""};if(_this3.answering.set(!0),_this3.copilotEngine){lastConversation.length>0&&(lastConversation[lastConversation.length-1]?.role===src.eV.User&&(prompt=lastConversation[lastConversation.length-1].content+"\n"+prompt,lastConversation.splice(lastConversation.length-1,1)),newConversation&&lastConversation.splice(0,lastConversation.length));const assistantIndex=_this3.conversations.length;try{_this3.askSubscriber=_this3.copilotEngine.process({prompt,messages:lastConversation}).subscribe({next:message=>{"string"==typeof message?(0,classPrivateFieldGet.Z)(_this3,_copilotEngine).upsertMessage({id:(0,dist.x0)(),role:"info",content:message}):message&&(0,classPrivateFieldGet.Z)(_this3,_copilotEngine).upsertMessage(message),_this3._cdr.detectChanges(),_this3.scrollBottom()},error:err=>{console.error(err);const conversations=[..._this3.conversations];conversations[assistantIndex]={...conversations[assistantIndex]},conversations[assistantIndex].content=null,conversations[assistantIndex].error=(0,helpers.e$)(err),_this3.answering.set(!1),_this3.conversationsChange.emit(_this3.conversations),_this3._cdr.detectChanges()},complete:()=>{_this3.answering.set(!1),_this3.conversations.length&&(_this3.conversationsChange.emit(_this3.conversations),_this3._cdr.detectChanges())}})}catch(err){_this3.answering.set(!1),_this3.conversationsChange.emit(_this3.conversations),_this3._cdr.detectChanges()}return}const messages=_this3.openaiOptions.useSystemPrompt&&_this3.systemPrompt?[{id:(0,dist.x0)(),role:src.eV.System,content:_this3.systemPrompt}]:[];messages.push(..._this3.conversations.filter((item=>!item.error&&!!item.content)).reduceRight(((prev,curr)=>prev.length?(curr.role===prev[prev.length-1].role?prev[prev.length-1].content=[curr.content,prev[prev.length-1].content].join("\n"):prev.push((0,pick.Z)(curr,"role","content")),prev):[(0,pick.Z)(curr,"role","content")]),[]).reverse()),_this3.scrollBottom(),_this3.askSubscriber=_this3.copilotService.chatStream(messages).pipe((0,scan.R)(((acc,value)=>acc+(value?.choices?.[0]?.delta?.content??"")),""),(0,map.U)((content=>content.trim()))).subscribe({next:content=>{assistant.content=content,_this3._cdr.detectChanges(),_this3.scrollBottom()},error:err=>{_this3.answering.set(!1),assistant.content=null,assistant.error=(0,helpers.e$)(err),_this3.conversationsChange.emit(_this3.conversations),_this3._cdr.detectChanges()},complete:()=>{_this3.answering.set(!1),_this3.conversationsChange.emit(_this3.conversations),_this3._cdr.detectChanges()}})}))()}stopGenerating(){this.askController?.abort(),this.askSubscriber?.unsubscribe(),this.answering.set(!1),this.conversationsChange.emit(this.conversations),this.scrollBottom()}onCopy(copyButton){copyButton.copied=!0,setTimeout((()=>{copyButton.copied=!1}),3e3)}scrollBottom(){setTimeout((()=>{this.chatsContent.nativeElement.scrollTo({top:this.chatsContent.nativeElement.scrollHeight,left:0,behavior:"smooth"})}),300)}send(text){var _this4=this;return(0,asyncToGenerator.Z)((function*(){_this4.promptControl.setValue(text)}))()}run(event){return(0,asyncToGenerator.Z)((function*(){console.log(event),yield navigator.clipboard.readText()}))()}clear(){var _this5=this;return(0,asyncToGenerator.Z)((function*(){(0,classPrivateFieldGet.Z)(_this5,_copilotEngine).clear(),_this5.conversationsChange.emit(_this5.conversations)}))()}closePopper(){this.popperjsContentComponent?.toggleVisibility(!1)}deleteMessage(message){(0,classPrivateFieldGet.Z)(this,_copilotEngine).deleteMessage(message),this.conversationsChange.emit(this.conversations)}resubmitMessage(message,content){var _this6=this;return(0,asyncToGenerator.Z)((function*(){(0,classPrivateFieldGet.Z)(_this6,_copilotEngine).updateConversations((conversations=>{const index=conversations.indexOf(message);return index>-1?(conversations[index+1]?.role===src.eV.Assistant&&conversations.splice(index+1,1),conversations.splice(index,1),[...conversations]):conversations})),yield _this6.askCopilotStream(content)}))()}onMessageFocus(){this._cdr.detectChanges()}isFoucs(target){return document.activeElement===target}triggerFun(event,autocomplete){if(!event.shiftKey||"Enter"!==event.key){if((0,classPrivateFieldGet.Z)(this,_suggestionsOpened).call(this)||"Enter"!==event.key||this.askCopilotStream(this.prompt()),"Tab"===event.key){event.preventDefault();const activatedPrompt=(0,classPrivateFieldGet.Z)(this,_activatedPrompt).call(this)||this.filteredCommands()[0].examples[0];activatedPrompt&&this.promptControl.setValue(activatedPrompt)}if(!autocomplete.isOpen&&("ArrowUp"===event.key||"ArrowDown"===event.key)){event.preventDefault();const historyQuestions=this.historyQuestions();if(historyQuestions.length){if("ArrowUp"===event.key&&this.historyIndex()<historyQuestions.length-1)this.historyIndex.set(this.historyIndex()+1);else{if(!("ArrowDown"===event.key&&this.historyIndex()>-1))return;this.historyIndex.set(this.historyIndex()-1)}this.promptControl.setValue(historyQuestions[this.historyIndex()]??"")}}}}onPromptActivated(event){(0,classPrivateFieldGet.Z)(this,_activatedPrompt).set(event.option?.value)}dropCopilot(event){this.copilotEngine&&this.copilotEngine.dropCopilot(event)}},chat_component_class.ctorParameters=()=>[],chat_component_class.propDecorators={welcomeTitle:[{type:core.Input}],welcomeSubTitle:[{type:core.Input}],placeholder:[{type:core.Input}],copilotEngine:[{type:core.Input}],user:[{type:core.Input}],copy:[{type:core.Output}],conversationsChange:[{type:core.Output}],chatsContent:[{type:core.ViewChild,args:["chatsContent"]}],copilotOptions:[{type:core.ViewChild,args:["copilotOptions"]}]},chat_component_class);NgmCopilotChatComponent=(0,tslib_es6.gn)([(0,core.Component)({standalone:!0,changeDetection:core.ChangeDetectionStrategy.OnPush,selector:"ngm-copilot-chat",template:'<div class="text-base font-semibold p-2">\n    <span>\n        {{ \'Ngm.Copilot.Copilot\' | translate: {Default: \'Copilot\'} }}\n    </span>\n\n    @if (copilotEngine?.name) {\n    <span>:</span><span>{{copilotEngine.name}}</span>\n    }\n</div>\n\n<div #chatsContent class="flex-1 flex flex-col overflow-y-auto overflow-x-hidden">\n    @for (conversation of (enabled && hasKey ? conversations : _mockConversations); track conversation.id) {\n        @switch (conversation.role) {\n            @case (CopilotChatMessageRoleEnum.Assistant) {\n            <div class="pl-2 pr-4 flex">\n                <div class="flex-1 flex items-start overflow-auto">\n                    <div class="flex flex-col items-center">\n                        <div class="w-8 h-8 rounded-full bg-bluegray-50 text-xl text-center font-notoColorEmoji">🤖</div>\n                    </div>\n                    <div class="flex flex-col justify-start items-start overflow-auto relative p-[10px] min-h-[50px] min-w-[50px] group">\n                        <div *ngIf="conversation.content" class="ngm-copilot-chat__message-content">\n                            <markdown clipboard class="whitespace-pre-line"\n                                [clipboardButtonTemplate]="buttonTemplate"\n                                lineNumbers\n                                [start]="5"\n                                [data]="conversation.content"\n                            ></markdown>\n                        </div>\n        \n                        <div *ngIf="conversation.error" class="ngm-copilot-chat__message-content text-red-400">\n                            <span class="font-notoColorEmoji">🙈</span>\n                            {{ conversation.error }}\n                        </div>\n    \n                        <ngm-copilot-token *ngIf="conversation.content" [content]="conversation.content"></ngm-copilot-token>\n    \n                        <button mat-icon-button displayDensity="compact" class="ngm-copilot__message-remove left-0 top-0 opacity-0 group-hover:opacity-100 transition-opacity duration-100"\n                            (click)="deleteMessage(conversation)">\n                            <mat-icon>close</mat-icon>\n                        </button>\n                    </div>\n                    \n                </div>\n            </div>\n            }\n            @case (CopilotChatMessageRoleEnum.User) {\n            <div class="pl-4 flex">\n                <div class="flex-1 flex items-start justify-end overflow-auto">\n                    <div class="flex flex-col justify-start items-end overflow-auto relative p-[10px] group">\n                        @if (conversation.data) {\n                            <ngm-table class="max-w-full rounded-lg border overflow-hidden"\n                                [columns]="conversation.data[\'columns\']"\n                                [data]="conversation.data[\'content\']"\n                                paging\n                                [pageSizeOptions]="[10, 20, 50, 100]"\n                            ></ngm-table>\n                        } @else {\n                            <div class="ngm-copilot-chat__message-content ngm-copilot__user-message flex flex-col items-end">\n                                <div #msgContent class="ngm-copilot-chat__message-edit whitespace-pre-wrap w-full focus-visible:outline-none\n                                focus-visible:bg-white dark:focus-visible:bg-black"\n                                    [attr.contenteditable]="true"\n                                    (focus)="onMessageFocus()"\n                                >{{ conversation.content }}</div>\n                            </div>\n                            <button *ngIf="isFoucs(msgContent)" mat-raised-button class="ngm-copilot__resubmit" displayDensity="compact"\n                                (click)="resubmitMessage(conversation, msgContent.textContent)">\n                                {{ \'Ngm.Copilot.Resubmit\' | translate: {Default: \'Resubmit\'} }}\n                            </button>\n                        }\n    \n                        <div class="flex items-center gap-1">\n                        @if (conversation.command) {\n                            <span class="text-xs font-medium italic px-2.5 py-0.5 rounded bg-neutral-100 dark:bg-neutral-700">/{{conversation.command}}</span>\n                        }\n                        @if (conversation.content) {\n                            <ngm-copilot-token [content]="conversation.content"></ngm-copilot-token>\n                        }\n                        </div>\n    \n                        <button mat-icon-button displayDensity="compact" class="ngm-copilot__message-remove right-0 top-0 opacity-0 group-hover:opacity-100 transition-opacity duration-100"\n                            (click)="deleteMessage(conversation)">\n                            <mat-icon>close</mat-icon>\n                        </button>\n                    </div>\n                    \n                    <ngm-copilopt-user-avatar class="shrink-0 w-8 h-8 rounded-full overflow-hidden" [user]="user"></ngm-copilopt-user-avatar>\n                </div>\n            </div>\n            }\n            @case (CopilotChatMessageRoleEnum.Info) {\n            <div class="pl-4 flex">\n                <div class="flex-1 flex items-start justify-end overflow-auto">\n                    <div class="rounded-lg py-2 px-4 w-full overflow-auto flex flex-col items-end">\n                        {{ conversation.content }}\n                    </div>\n                </div>\n            </div>\n            }\n        }\n    }\n\n    <div class="flex-1 flex flex-col justify-center items-center gap-1">\n    @if (!conversations?.length) {\n        <div class="text-lg">\n            <span class="text-xl">💡</span>{{ \'Ngm.Copilot.AskAICopilot\' | translate: {Default: \'Ask AI Copilot Questions\'} }}\n        </div>\n        <div class="text-sm font-light opacity-50">\n            <span class="font-bold">/Command</span> + {{ \'Ngm.Copilot.Prompt\' | translate: {Default: \'prompt\'} }}\n        </div>\n        <div class="text-sm font-light opacity-50">\n            <span class="font-bold">Enter</span> {{ \'Ngm.Copilot.SendPrompt\' | translate: {Default: \'send prompt\'} }}\n        </div>\n    }\n    </div>\n    \n    \x3c!-- <ng-container *ngIf="prompts?.length">\n        <div class="border-dashed border-t border-t-slate-200 w-full flex justify-center my-4">\n            <span class="-mt-3 px-2 bg-slate-50 inline-flex items-center">{{ \'Ngm.Copilot.ExamplesOfPrompts\' | translate: {Default: \'Examples of Prompt\'} }}\n                <button (click)="examplesOpened=!examplesOpened">\n                    <svg data-accordion-icon class="w-6 h-6 shrink-0 text-neutral-300 hover:text-neutral-400"\n                        [class.rotate-180]="!examplesOpened"\n                        fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">\n                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>\n                    </svg>\n                </button>\n            </span>\n        </div>\n        <div class="max-h-[30%] min-h-[100px] overflow-auto pl-4 flex flex-col items-end"\n            [class.min-h-0]="!examplesOpened"\n            [class.h-0]="!examplesOpened"\n            [class.min-h-[200px]]="examplesOpened"\n        >\n            <div *ngFor="let prompt of prompts" class="mb-2 mx-2 bg-slate-200 rounded-lg py-2 px-4">\n                <a class="cursor-pointer hover:underline"\n                    (click)="askPredefinedPrompt(prompt)">\n                    {{ \'Ngm.Copilot.Prompts.\'+prompt | translate: {Default: prompt} }}</a>\n            </div>\n        </div>\n    </ng-container> --\x3e\n    \n</div>\n\n<div class="relative m-3 border rounded-lg shadow-sm border-neutral-200 dark:border-neutral-800"\n    [class.ngm-colpilot__active]="isFoucs(userInput)"\n>\n    <mat-progress-bar mode="buffer" [class.opacity-100]="answering()" class="opacity-0 top-0 left-0 w-full transition duration-300" style="position: absolute; z-index: 1;"></mat-progress-bar>\n    @if (answering()) {\n        <div class="ngm-copilot-chat__answering absolute inset-0 flex justify-center items-center">\n            <button mat-stroked-button displayDensity="cosy" class="rounded-full"\n                (click)="$event.stopPropagation();stopGenerating()">\n                <div class="copilot-message-stop flex items-center">\n                    <span>\n                        {{ \'Ngm.Copilot.StopGenerating\' | translate: {Default: \'Stop generating\'} }}\n                    </span>\n                </div>\n            </button>\n        </div>\n    }\n\n    <div class="flex flex-col p-2" >\n        <textarea #userInput matInput\n            id="userInput" onInput="this.parentNode.dataset.replicatedValue = this.value"\n            [placeholder]="_placeholder || (\'Ngm.Copilot.Placeholder\' | translate: {Default: \'Ask Copilot or type / for commands\'})"\n            [formControl]="promptControl"\n            cdkTextareaAutosize\n            cdkAutosizeMinRows="1"\n            cdkAutosizeMaxRows="8"\n            (keydown)="triggerFun($event, autoPrompts)"\n\n            [matAutocomplete]="autoPrompts"\n            matAutocompletePosition="above"\n            >\n        </textarea>\n\n        <mat-autocomplete #autoPrompts="matAutocomplete" class="ngm-copilot-chat__autocomplete-panel ngm-autocomplete-panel ngm-density__compact"\n            autoActiveFirstOption hideSingleSelectionIndicator\n            (optionActivated)="onPromptActivated($event)"\n            (opened)="suggestionsOpened$.next(true)"\n            (closed)="suggestionsOpened$.next(false)"\n        >\n        @for (command of filteredCommands();  track command.prompt) {\n            <mat-option [value]="\'/\'+command.name+\' \'+(command.example || \'\')" [title]="command.description">\n                <span class="bg-gray-200 text-neutral-800 text-xs font-medium me-2 px-1 mr-1 rounded dark:bg-gray-900 dark:text-neutral-300">\n                    /{{command.name}}\n                </span>\n                \n                @if (command.example) {\n                    <div class="whitespace-nowrap text-ellipsis overflow-hidden text-gray-500 italic"\n                        [ngmHighlight]="prompt()"\n                        [content]="command.example"\n                        customClasses="text-gray-600 bg-gray-200 font-bold not-italic"\n                    >{{command.example}}</div>\n                } @else {\n                    <span class="ml-auto opacity-50">{{command.description}}</span>\n                }\n            </mat-option>\n        }\n        </mat-autocomplete>\n\n        <div class="shrink-0 flex items-center">\n            <button mat-icon-button type="button" displayDensity="cosy"\n                [popper]="copilotOptions"\n                [popperTrigger]="NgxPopperjsTriggers.click"\n                [popperHideOnClickOutside]="true"\n                [popperHideOnScroll]="true"\n                [popperHideOnMouseLeave]="false"\n                [popperPlacement]="NgxPopperjsPlacements.TOPEND"\n            >\n                <mat-icon fontSet="material-icons-round">tune</mat-icon>\n            </button>\n\n            <span class="flex-1"></span>\n\n            <button mat-icon-button displayDensity="cosy"\n                [disabled]="!prompt() || answering()"\n                (click)="askCopilotStream(promptControl.value)"\n            >\n                <mat-icon fontSet="material-icons-round">send</mat-icon>\n            </button>\n        </div>\n    </div>\n</div>\n\n@if (!copilotEnabled) {\n<ngm-copilot-enable class="z-[101]"\n    [title]="welcomeTitle || \'Metad Copilot\'"\n    [subTitle]="welcomeSubTitle || (\'Ngm.Copilot.YourAIPairProgrammer\' | translate: {Default: \'Your AI pair programmer\'})"\n    (toConfig)="closePopper()"/>\n}\n\n<popper-content #copilotOptions class="z-[101]">\n    <div class="w-80 flex flex-col max-w-sm p-4 border-0 border-gray-200 rounded-lg shadow-lg\n        dark:bg-gray-800 dark:border-gray-700 bg-white/60 backdrop-blur-lg"\n        displayDensity="compact">\n        <div class="text-base mb-2">\n            {{ \'Ngm.Copilot.Options\' | translate: {Default: \'Options\'} }}\n        </div>\n\n        <section *ngIf="systemPrompt" [matTooltip]="systemPrompt" matTooltipPosition="above">\n            <mat-checkbox [(ngModel)]="useSystemPrompt">\n                {{ \'Ngm.Copilot.UseSystemPrompt\' | translate: {Default: \'Use System Prompt\'} }}\n            </mat-checkbox>\n        </section>\n\n        <div class="mt-2 font-notoColorEmoji flex justify-between items-center">\n            <label class="flex-1">\n                {{ \'Ngm.Copilot.Model\' | translate: {Default: \'Model\'} }}:<span matTooltip="ID of the model to use.">💡</span>\n            </label>\n            \n            <button mat-icon-button displayDensity="compact" (click)="refreshModels()">\n                <mat-icon>refresh</mat-icon>\n            </button>\n        </div>\n\n        <ngm-search class="w-full" [formControl]="searchModel"></ngm-search>\n        <mat-selection-list class="flex flex-col gap-2 max-h-[120px] overflow-auto"\n            [(ngModel)]="selectedModel"\n            [multiple]="false"\n            (ngModelChange)="changeSelectedModel($event)">\n            <mat-list-option *ngFor="let model of models()" [value]="model.id">\n                {{model.label}}\n            </mat-list-option>\n        </mat-selection-list>\n\n        <label class="pt-4 font-notoColorEmoji">Temperature:<span matTooltip="What sampling temperature to use, between 0 and 2. Higher values like 0.8 will make the output more random, while lower values like 0.2 will make it more focused and deterministic. We generally recommend altering this or top_p but not both.">💡</span></label>\n        <mat-slider color="accent" min="0" max="2" step="0.1" value="1" discrete>\n            <input matSliderThumb [(ngModel)]="temperature">\n        </mat-slider>\n        \n        <label class="pt-4 font-notoColorEmoji">Choices:<span matTooltip="How many chat completion choices to generate for each input message.">💡</span></label>\n        <mat-slider color="accent" min="1" max="10" step="1" value="1" discrete>\n            <input matSliderThumb [(ngModel)]="n">\n        </mat-slider>\n\n        <button mat-stroked-button displayDensity="cosy" class="pac-colpilot__clear-messages" (click)="clear()">\n            {{ \'Ngm.Copilot.ClearMessages\' | translate: {Default: \'Clear messages\'} }}\n        </button>\n    </div>\n</popper-content>\n\n<ng-template #buttonTemplate>\n    \x3c!-- <button mat-flat-button displayDensity="compact" class="ngm-rounded-full"\n        (click)="run($event)">run</button> --\x3e\n    <button #copyButton mat-flat-button displayDensity="compact" class="ngm-rounded-full" (click)="onCopy(copyButton)">\n        {{ $any(copyButton).copied ? \'copied\' : \'copy\' }}\n    </button>\n</ng-template>\n',imports:[common.CommonModule,fesm2022_forms.u5,fesm2022_forms.UX,router.Bz,text_field.Ky,clipboard.Iq,input.c,icon.Ps,fesm2022_button.ot,tooltip.AV,autocomplete.Bb,progress_bar.Cv,list.ie,slider.KP,ngx_translate_core.aw,ngx_popperjs.X_,ngx_markdown.JP,displayDensity.Z,search_component.K,NgmTableComponent,NgmHighlightDirective,CopilotChatTokenComponent,CopilotEnableComponent,UserAvatarComponent],host:{class:"ngm-copilot-chat"},styles:[chat_componentngResource_default()]}),(0,tslib_es6.w6)("design:paramtypes",[])],NgmCopilotChatComponent)},"./packages/angular/copilot/hooks/inject-copilot-command.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{K:()=>injectCopilotCommand});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_services__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/angular/copilot/services/engine.service.ts");function injectCopilotCommand(command){const copilotEngine=(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(_services__WEBPACK_IMPORTED_MODULE_1__.S);return copilotEngine.registerCommand(command.name,command),(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.inject)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.DestroyRef).onDestroy((()=>{copilotEngine.unregisterCommand(command.name)})),command.name}},"./packages/angular/copilot/services/client-copilot.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{x:()=>NgmClientCopilotService});var _class,_copilotConfigFactory,NgmClientCopilotService_1,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldInitSpec_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js"),_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet.js"),tslib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_metad_copilot__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/copilot/src/index.ts");let NgmClientCopilotService=(_copilotConfigFactory=new WeakMap,_class=class NgmClientCopilotService extends _metad_copilot__WEBPACK_IMPORTED_MODULE_0__.yY{constructor(){super(),(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldInitSpec_js__WEBPACK_IMPORTED_MODULE_1__.Z)(this,_copilotConfigFactory,{writable:!0,value:(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.inject)(NgmClientCopilotService_1.CopilotConfigFactoryToken)}),(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_3__.Z)(this,_copilotConfigFactory).call(this).then((copilot=>{this.copilot=copilot}))}requestOptions(){return{headers:{Authorization:`Bearer ${this.copilot.apiKey}`}}}},NgmClientCopilotService_1=_class,_class.CopilotConfigFactoryToken=new _angular_core__WEBPACK_IMPORTED_MODULE_2__.InjectionToken("CopilotConfigFactoryToken"),_class.ctorParameters=()=>[],_class);NgmClientCopilotService=NgmClientCopilotService_1=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.Injectable)(),(0,tslib__WEBPACK_IMPORTED_MODULE_4__.w6)("design:paramtypes",[])],NgmClientCopilotService)},"./packages/angular/copilot/services/engine.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>NgmCopilotEngineService});var _logger,_entryPoints,_commands,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldInitSpec_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js"),_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet.js"),_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldSet_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldSet.js"),tslib__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_metad_copilot__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/copilot/src/index.ts"),ai__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/ai/dist/index.mjs"),lodash_es__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/lodash-es/pick.js"),ngx_logger__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/ngx-logger/fesm2020/ngx-logger.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/throwError.js"),rxjs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/from.js"),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js");let uniqueId=0,NgmCopilotEngineService=(_logger=new WeakMap,_entryPoints=new WeakMap,_commands=new WeakMap,class NgmCopilotEngineService{constructor(){(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldInitSpec_js__WEBPACK_IMPORTED_MODULE_1__.Z)(this,_logger,{writable:!0,value:void 0}),(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldInitSpec_js__WEBPACK_IMPORTED_MODULE_1__.Z)(this,_entryPoints,{writable:!0,value:void 0}),(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldInitSpec_js__WEBPACK_IMPORTED_MODULE_1__.Z)(this,_commands,{writable:!0,value:void 0}),(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldSet_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,_logger,(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.inject)(ngx_logger__WEBPACK_IMPORTED_MODULE_4__.Kf,{optional:!0})),this.copilot=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.inject)(_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.yY),this.api=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.signal)("/api/chat"),this.chatId="chat-"+uniqueId++,this.key=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.computed)((()=>`${this.api()}|${this.chatId}`)),this.aiOptions={model:_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.lZ},this.conversations$=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.signal)([]),(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldSet_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,_entryPoints,(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.signal)({})),this.getFunctionCallHandler=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.computed)((()=>(0,_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.hs)(Object.values((0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_entryPoints).call(this))))),this.getChatCompletionFunctionDescriptions=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.computed)((()=>(0,_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.Py)(Object.values((0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_entryPoints).call(this))))),(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldSet_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,_commands,(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.signal)({})),this.commands=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.computed)((()=>Object.values((0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_commands).call(this)))),this.messages=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.signal)([]),this.error=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.signal)(void 0),this.streamData=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.signal)(void 0),this.isLoading=(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.signal)(!1)}get conversations(){return this.conversations$()}setEntryPoint(id,entryPoint){(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_entryPoints).update((state=>({...state,[id]:entryPoint})))}removeEntryPoint(id){(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_entryPoints).update((prevPoints=>{const newPoints={...prevPoints};return delete newPoints[id],newPoints}))}registerCommand(name,command){(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_commands).update((state=>({...state,[name]:command})))}unregisterCommand(name){(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_commands).update((state=>(delete state[name],{...state})))}getCommand(name){return(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_commands).call(this)[name]}process(data,options){(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_logger)?.debug(`process ask: ${data.prompt}`);const newMessages=[],{command,prompt}=(0,_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.uF)(data.prompt);if(command){const _command=this.getCommand(command);return _command?(_command.systemPrompt&&newMessages.push({id:(0,ai__WEBPACK_IMPORTED_MODULE_7__.x0)(),role:_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.eV.System,content:_command.systemPrompt()}),newMessages.push({id:(0,ai__WEBPACK_IMPORTED_MODULE_7__.x0)(),role:_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.eV.User,content:prompt,command}),this.conversations$.update((state=>[...state,...newMessages])),_command.implementation?(0,rxjs__WEBPACK_IMPORTED_MODULE_8__.D)(_command.implementation()):(0,rxjs__WEBPACK_IMPORTED_MODULE_8__.D)(this.triggerRequest([...data.messages??[],...newMessages],{options:{body:{...this.aiOptions,functions:_command.actions?(0,_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.Py)(_command.actions.map((id=>(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(this,_entryPoints).call(this)[id]))):this.getChatCompletionFunctionDescriptions()}}})).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.U)((()=>"")))):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__._)((()=>new Error(`Command '${command}' not found`)))}return newMessages.push({id:(0,ai__WEBPACK_IMPORTED_MODULE_7__.x0)(),role:_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.eV.User,content:prompt}),this.conversations$.update((state=>[...state,...newMessages])),(0,rxjs__WEBPACK_IMPORTED_MODULE_8__.D)(this.triggerRequest([...data.messages??[],...newMessages],{options:{body:{...this.aiOptions,functions:this.getChatCompletionFunctionDescriptions()}}})).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.U)((()=>"")))}triggerRequest(messagesSnapshot,{options,data}={}){var _this=this;return(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_10__.Z)((function*(){let abortController=null;try{_this.error.set(void 0),_this.isLoading.set(!0),abortController=new AbortController;const getCurrentMessages=()=>_this.messages()??[];let chatRequest={messages:messagesSnapshot,options,data};return yield(0,_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.fe)({getStreamedResponse:(_ref=(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_10__.Z)((function*(){try{return yield _this.copilot.chat({body:{...(0,lodash_es__WEBPACK_IMPORTED_MODULE_11__.Z)(_this.aiOptions,"model","temperature"),...options?.body??{}},onFinish:message=>{console.log("onFinish",message),_this.conversations$.update((state=>[...state,message]))}},chatRequest,{options,data},abortController)}catch(err){throw _this.conversations$.update((state=>[...state,{id:(0,ai__WEBPACK_IMPORTED_MODULE_7__.x0)(),role:_metad_copilot__WEBPACK_IMPORTED_MODULE_0__.eV.Assistant,content:"",error:err.message}])),err}})),function getStreamedResponse(){return _ref.apply(this,arguments)}),experimental_onFunctionCall:_this.getFunctionCallHandler(),updateChatRequest:newChatRequest=>{chatRequest=newChatRequest,(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_classPrivateFieldGet_js__WEBPACK_IMPORTED_MODULE_5__.Z)(_this,_logger)?.debug("The new chat request after FunctionCall is",newChatRequest),_this.conversations$.update((state=>{const messages=[...state];return newChatRequest.messages.forEach((message=>{const index=messages.findIndex((item=>item.id&&item.id===message.id));index>-1?messages[index]=message:messages.push(message)})),messages}))},getCurrentMessages:()=>getCurrentMessages()}),abortController=null,null}catch(err){return"AbortError"===err.name?(abortController=null,null):(err instanceof Error&&_this.error.set(err),_this.error.set(err),null)}finally{_this.isLoading.set(!1)}var _ref}))()}append(message,options){var _this2=this;return(0,_home_runner_work_ocap_ocap_node_modules_angular_devkit_build_angular_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_10__.Z)((function*(){return message.id||(message.id=_this2.generateId()),_this2.triggerRequest((_this2.messages()??[]).concat(message),options)}))()}generateId(){return(0,ai__WEBPACK_IMPORTED_MODULE_7__.x0)()}upsertMessage(message){this.conversations$.update((conversations=>{const index=conversations.findIndex((item=>item.id===message.id));return index>-1?conversations[index]={...message}:conversations.push(message),[...conversations]}))}deleteMessage(message){this.conversations$.update((conversations=>{const index=conversations.findIndex((item=>item.id===message.id));return index&&conversations.splice(index,1),[...conversations]}))}clear(){this.conversations$.set([])}updateConversations(fn){this.conversations$.update(fn)}});NgmCopilotEngineService=(0,tslib__WEBPACK_IMPORTED_MODULE_12__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.Injectable)()],NgmCopilotEngineService)},"./packages/angular/core/core.module.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>OcapCoreModule});var OcapCoreModule_1,tslib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_core_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/angular/core/core.service.ts"),_directives__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/angular/core/directives/displayDensity.ts"),_directives__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/angular/core/directives/appearance.ts"),_directives__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/angular/core/directives/button-group.directive.ts");let OcapCoreModule=OcapCoreModule_1=class OcapCoreModule{static forRoot(){return{ngModule:OcapCoreModule_1,providers:[_core_service__WEBPACK_IMPORTED_MODULE_0__.q]}}};OcapCoreModule=OcapCoreModule_1=(0,tslib__WEBPACK_IMPORTED_MODULE_1__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.NgModule)({imports:[_directives__WEBPACK_IMPORTED_MODULE_3__.Z,_directives__WEBPACK_IMPORTED_MODULE_4__.A,_directives__WEBPACK_IMPORTED_MODULE_5__.d],exports:[_directives__WEBPACK_IMPORTED_MODULE_3__.Z,_directives__WEBPACK_IMPORTED_MODULE_4__.A,_directives__WEBPACK_IMPORTED_MODULE_5__.d],declarations:[],providers:[]})],OcapCoreModule)},"./packages/angular/core/core.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>NgmDSCoreService});var _class,tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),src=__webpack_require__("./packages/core/src/index.ts"),Subject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js"),merge=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/merge.js"),empty=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/empty.js"),types=__webpack_require__("./packages/angular/core/types.ts");let NgmAgentService=((_class=class NgmAgentService{constructor(agents){this.agents=agents,this.error$=new Subject.x,this._error$=(0,merge.T)(...this.agents.map((agent=>agent.selectError())))}selectLocalAgentStatus(){const localAgent=this.agents.find((agent=>agent.type===src.buO.Local));if(!localAgent)throw new Error("Can't found Local Agent config");return localAgent?.selectStatus()??empty.E}error(err){this.error$.next(err)}selectError(){return this._error$}}).ctorParameters=()=>[{type:Array,decorators:[{type:core.Inject,args:[types.fH]}]}],_class);NgmAgentService=(0,tslib_es6.gn)([(0,core.Injectable)(),(0,tslib_es6.w6)("design:paramtypes",[Array])],NgmAgentService);let NgmDSCacheService=class NgmDSCacheService extends src.eNP{};var core_service_class;NgmDSCacheService=(0,tslib_es6.gn)([(0,core.Injectable)()],NgmDSCacheService);let NgmDSCoreService=((core_service_class=class NgmDSCoreService extends src.Q$V{constructor(agents,models,dataSourceFactory,cacheService){super(agents,models,dataSourceFactory,cacheService),this.agents=agents,this.models=models,this.dataSourceFactory=dataSourceFactory}ngOnDestroy(){super.onDestroy()}}).ctorParameters=()=>[{type:Array,decorators:[{type:core.Inject,args:[types.fH]}]},{type:Array,decorators:[{type:core.Optional},{type:core.Inject,args:[types.ET]}]},{type:Array,decorators:[{type:core.Optional},{type:core.Inject,args:[types.OF]}]},{type:NgmDSCacheService,decorators:[{type:core.Optional}]}],core_service_class);NgmDSCoreService=(0,tslib_es6.gn)([(0,core.Injectable)(),(0,tslib_es6.w6)("design:paramtypes",[Array,Array,Array,NgmDSCacheService])],NgmDSCoreService)},"./packages/angular/core/directives/appearance.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>AppearanceDirective});var _class,tslib__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_cdk_a11y__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/a11y.mjs"),_angular_cdk_coercion__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/coercion.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_angular_material_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/material/fesm2022/core.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js");const _NgmAppearanceBase=(0,_angular_material_core__WEBPACK_IMPORTED_MODULE_0__.pj)(class{constructor(_elementRef){this._elementRef=_elementRef}});let AppearanceDirective=((_class=class AppearanceDirective extends _NgmAppearanceBase{get outline(){return"outline"===this.ngmAppearance}set outline(value){(0,_angular_cdk_coercion__WEBPACK_IMPORTED_MODULE_1__.Ig)(value)&&(this.ngmAppearance="outline")}get hero(){return"hero"===this.ngmAppearance}set hero(value){(0,_angular_cdk_coercion__WEBPACK_IMPORTED_MODULE_1__.Ig)(value)&&(this.ngmAppearance="hero")}get acrylic(){return"acrylic"===this.ngmAppearance}set acrylic(value){(0,_angular_cdk_coercion__WEBPACK_IMPORTED_MODULE_1__.Ig)(value)&&(this.ngmAppearance="acrylic")}get opacity(){return"opacity"===this.ngmAppearance}set opacity(value){(0,_angular_cdk_coercion__WEBPACK_IMPORTED_MODULE_1__.Ig)(value)&&(this.ngmAppearance="opacity")}get dashed(){return"dashed"===this.ngmAppearance}set dashed(value){(0,_angular_cdk_coercion__WEBPACK_IMPORTED_MODULE_1__.Ig)(value)&&(this.ngmAppearance="dashed")}get danger(){return"danger"===this.ngmAppearance}set danger(value){(0,_angular_cdk_coercion__WEBPACK_IMPORTED_MODULE_1__.Ig)(value)&&(this.ngmAppearance="danger")}constructor(elementRef,_focusMonitor){super(elementRef),this._focusMonitor=_focusMonitor,this.ngmAppearance="filled",this._onFocus=new rxjs__WEBPACK_IMPORTED_MODULE_2__.x,this._hasFocus=!1}focus(){this._hasFocus||(this._elementRef.nativeElement.focus(),this._onFocus.next({chip:this})),this._hasFocus=!0}getLabel(){throw new Error("Method not implemented.")}}).ctorParameters=()=>[{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.ElementRef},{type:_angular_cdk_a11y__WEBPACK_IMPORTED_MODULE_4__.tE}],_class.propDecorators={ngmAppearance:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.Input}],outline:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.Input},{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.HostBinding,args:["class.ngm-appearance-outline"]}],hero:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.Input},{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.HostBinding,args:["class.ngm-appearance-hero"]}],acrylic:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.Input},{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.HostBinding,args:["class.ngm-appearance-acrylic"]}],opacity:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.Input},{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.HostBinding,args:["class.ngm-appearance-opacity"]}],dashed:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.Input},{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.HostBinding,args:["class.ngm-appearance-dashed"]}],danger:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.Input},{type:_angular_core__WEBPACK_IMPORTED_MODULE_3__.HostBinding,args:["class.ngm-appearance-danger"]}]},_class);AppearanceDirective=(0,tslib__WEBPACK_IMPORTED_MODULE_5__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.Directive)({standalone:!0,selector:"[ngmAppearance]",inputs:["color"],host:{"(focus)":"focus()"}}),(0,tslib__WEBPACK_IMPORTED_MODULE_5__.w6)("design:paramtypes",[_angular_core__WEBPACK_IMPORTED_MODULE_3__.ElementRef,_angular_cdk_a11y__WEBPACK_IMPORTED_MODULE_4__.tE])],AppearanceDirective)},"./packages/angular/core/directives/button-group.directive.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{d:()=>ButtonGroupDirective});var _class,tslib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs");let ButtonGroupDirective=((_class=class ButtonGroupDirective{constructor(elementRef){this.elementRef=elementRef}}).ctorParameters=()=>[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.ElementRef}],_class);ButtonGroupDirective=(0,tslib__WEBPACK_IMPORTED_MODULE_1__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.Directive)({standalone:!0,selector:"[ngmButtonGroup]",host:{class:"ngm-button-group"}}),(0,tslib__WEBPACK_IMPORTED_MODULE_1__.w6)("design:paramtypes",[_angular_core__WEBPACK_IMPORTED_MODULE_0__.ElementRef])],ButtonGroupDirective)},"./packages/angular/core/directives/displayDensity.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>DisplayDensity,Z:()=>DensityDirective});var _class,DisplayDensity,tslib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs");!function(DisplayDensity){DisplayDensity.comfortable="comfortable",DisplayDensity.cosy="cosy",DisplayDensity.compact="compact"}(DisplayDensity||(DisplayDensity={}));let DensityDirective=((_class=class DensityDirective{get densityCosy(){return this.displayDensity===DisplayDensity.comfortable}get densityCompact(){return this.displayDensity===DisplayDensity.compact}get densityComfortable(){return this.displayDensity===DisplayDensity.cosy}}).propDecorators={displayDensity:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.Input}],densityCosy:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostBinding,args:["class.ngm-density__comfortable"]}],densityCompact:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostBinding,args:["class.ngm-density__compact"]}],densityComfortable:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_0__.HostBinding,args:["class.ngm-density__cosy"]}]},_class);DensityDirective=(0,tslib__WEBPACK_IMPORTED_MODULE_1__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.Directive)({standalone:!0,selector:"[displayDensity]"})],DensityDirective)},"./packages/angular/core/helpers.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Sy:()=>splitByHighlight,e$:()=>getErrorMessage});var _class,tslib__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),_angular_common_http__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@angular/common/fesm2022/http.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),lodash_es__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash-es/negate.js"),lodash_es__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash-es/isNil.js"),lodash_es__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/lodash-es/isEqual.js"),lodash_es__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/lodash-es/isEmpty.js"),lodash_es__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/lodash-es/includes.js"),rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js");(0,lodash_es__WEBPACK_IMPORTED_MODULE_0__.Z)(lodash_es__WEBPACK_IMPORTED_MODULE_1__.Z),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.h)((0,lodash_es__WEBPACK_IMPORTED_MODULE_0__.Z)(lodash_es__WEBPACK_IMPORTED_MODULE_1__.Z)),(0,lodash_es__WEBPACK_IMPORTED_MODULE_0__.Z)(lodash_es__WEBPACK_IMPORTED_MODULE_3__.Z),(0,lodash_es__WEBPACK_IMPORTED_MODULE_0__.Z)(lodash_es__WEBPACK_IMPORTED_MODULE_4__.Z);var KEYCODES,KEYS;!function(KEYCODES){KEYCODES[KEYCODES.ENTER=13]="ENTER",KEYCODES[KEYCODES.SPACE=32]="SPACE",KEYCODES[KEYCODES.ESCAPE=27]="ESCAPE",KEYCODES[KEYCODES.LEFT_ARROW=37]="LEFT_ARROW",KEYCODES[KEYCODES.UP_ARROW=38]="UP_ARROW",KEYCODES[KEYCODES.RIGHT_ARROW=39]="RIGHT_ARROW",KEYCODES[KEYCODES.DOWN_ARROW=40]="DOWN_ARROW",KEYCODES[KEYCODES.F2=113]="F2",KEYCODES[KEYCODES.TAB=9]="TAB",KEYCODES[KEYCODES.CTRL=17]="CTRL",KEYCODES[KEYCODES.Z=90]="Z",KEYCODES[KEYCODES.Y=89]="Y",KEYCODES[KEYCODES.X=88]="X",KEYCODES[KEYCODES.BACKSPACE=8]="BACKSPACE",KEYCODES[KEYCODES.DELETE=46]="DELETE",KEYCODES[KEYCODES.INPUT_METHOD=229]="INPUT_METHOD"}(KEYCODES||(KEYCODES={})),function(KEYS){KEYS.ENTER="Enter",KEYS.SPACE=" ",KEYS.SPACE_IE="Spacebar",KEYS.ESCAPE="Escape",KEYS.ESCAPE_IE="Esc",KEYS.LEFT_ARROW="ArrowLeft",KEYS.LEFT_ARROW_IE="Left",KEYS.UP_ARROW="ArrowUp",KEYS.UP_ARROW_IE="Up",KEYS.RIGHT_ARROW="ArrowRight",KEYS.RIGHT_ARROW_IE="Right",KEYS.DOWN_ARROW="ArrowDown",KEYS.DOWN_ARROW_IE="Down",KEYS.F2="F2",KEYS.TAB="Tab",KEYS.SEMICOLON=";",KEYS.HOME="Home",KEYS.END="End"}(KEYS||(KEYS={}));let PlatformUtil=((_class=class PlatformUtil{constructor(platformId){this.platformId=platformId,this.isBrowser=(0,_angular_common__WEBPACK_IMPORTED_MODULE_5__.isPlatformBrowser)(this.platformId),this.isIOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window)}}).ctorParameters=()=>[{type:Object,decorators:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_6__.Inject,args:[_angular_core__WEBPACK_IMPORTED_MODULE_6__.PLATFORM_ID]}]}],_class);PlatformUtil=(0,tslib__WEBPACK_IMPORTED_MODULE_7__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.Injectable)({providedIn:"root"}),(0,tslib__WEBPACK_IMPORTED_MODULE_7__.w6)("design:paramtypes",[Object])],PlatformUtil);const NAVIGATION_KEYS=new Set(["down","up","left","right","arrowdown","arrowup","arrowleft","arrowright","home","end","space","spacebar"," "]);new Set("right down arrowright arrowdown".split(" ")),new Set("left up arrowleft arrowup".split(" ")),new Set([...Array.from(NAVIGATION_KEYS),"tab","enter","f2","escape","esc"]);function splitByHighlight(text,highlight){if(highlight&&text){const keywords=highlight.split(/\s+/g),matchs=String(text).match(new RegExp(`(${keywords.join("|")})`,"ig")),results=String(text).split(new RegExp(`(${keywords.join("|")})`,"i"));if(results?.length>1)return results.map((value=>(0,lodash_es__WEBPACK_IMPORTED_MODULE_8__.Z)(matchs,value)?{match:!0,value}:{value}))}return[{value:text}]}function getErrorMessage(err){let error;return"string"==typeof err?error=err:err instanceof _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.UA?error=err?.error?.message??err.message:err instanceof Error?error=err?.message:err?.error instanceof Error?error=err?.error?.message:err&&(error=JSON.stringify(err)),error}},"./packages/angular/core/i18n/missing-tanslation.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{l:()=>NgmMissingTranslationHandler});class NgmMissingTranslationHandler{handle(params){return params.interpolateParams&&params.interpolateParams.Default||params.key}}},"./packages/angular/core/types.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ET:()=>OCAP_MODEL_TOKEN,OF:()=>OCAP_DATASOURCE_TOKEN,fH:()=>OCAP_AGENT_TOKEN});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs");const OCAP_AGENT_TOKEN=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("OCAP-Agent"),OCAP_MODEL_TOKEN=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("OCAP-Model"),OCAP_DATASOURCE_TOKEN=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("OCAP-DataSource")},"./packages/angular/i18n/zhHans.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>ZhHans});const ZhHans={Ngm:{Common:{Cancel:"取消",Apply:"应用",Search:"搜索",Select:"选择",Search_Placeholder:"请输入关键词",DisplayBehaviour_Description:"描述",DisplayBehaviour_DescriptionID:"描述 ID",DisplayBehaviour_IDDescription:"ID 描述",DisplayBehaviour_ID:"ID",DisplayBehaviour_Auto:"自动",SelectionType_Single:"单选",SelectionType_Multiple:"多选",Presentation_Flat:"平铺",Presentation_Hierarchy:"层级",HierarchySelectionMode_Individual:"单个",HierarchySelectionMode_SelfDescendants:"自己和后代",HierarchySelectionMode_DescendantsOnly:"只后代",HierarchySelectionMode_SelfChildren:"自己和子代",HierarchySelectionMode_ChildrenOnly:"只子代",Measures:"度量",None:"无",Default:"默认"},AnalyticalCard:{Screenshot:"截图",DataDownload:"下载数据",Refresh:"刷新",DrillDown:"下钻",DrillLevel:"层级下钻",DrillDimension:"维度下钻",LinkAnalysis:"联动筛选",DataEmpty:"数据为空"},AnalyticalGrid:{DataDownload:"下载数据",SORT:"排序",MOVE:"移动",ASCENDING:"正序",DESCENDGING:"倒序",MOVELEFT:"向左",MOVERIGHT:"向右",Search:"搜索",SelectAll:"选择所有",Pin:"固定"},Controls:{ValueHelp:{Title:"为{{value}}设置过滤器",AvailableMembers:"可选成员",DisplayBehaviour:"展现形式",SelectedMembers:"选中成员",ClearSelection:"清空选择",ShowUnbookedMembers:"显示未分配成员",ShowAllMember:"显示‘所有’成员",ShowOnlyLeaves:"只显示叶子节点",ExcludeSelectedMembers:"排除选中成员",SelectionType:"选择类型",Presentation:"展现形式",HierarchySelectionMode:"层级选择模式",Hierarchy:"层次结构"}},Copilot:{Copilot:"副驾驶",AICopilot:"AI 副驾驶",EnableCopilot:"启用 Copilot",GetYourApiKey:"获取你的 API Key",ProvideOpenaiApiKey:"请提供 Openai API Key?",Provider:"提供商",YourAIPairProgrammer:"你的 AI 配对程序员!",LetYourAIPairProgrammerEdits:"让你的 AI 配对程序员修改一下!",SelectSomeCode:"选择代码，让你的 AI 配对程序员修改一下!",ThinkingHard:"努力思考中...",StopGenerating:"停止生成",ClearMessages:"清空消息",CharacterLength:"字数",Resubmit:"重新提交",Model:"模型",Options:"选项",UseSystemPrompt:"使用系统提示",ExamplesOfPrompts:"提示语示例",APIKey:"API 密钥",APIHost:"API 主机",AskAICopilot:"向 AI 副驾驶询问问题",Prompt:"提示",SendPrompt:"发送提问",Placeholder:"询问副驾驶或输入 / 获取命令"},Entity:{SelectEntities:"选择数据集"},EntitySchema:{Parameters:"参数",Measures:"度量",Properties:"属性"},Formula:{Editor:{EditFormula:"编辑公式",Format:"格式化",Help:"帮助"}}}}},"./packages/angular/mock/logger.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{j:()=>provideLogger});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),ngx_logger__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/ngx-logger/fesm2020/ngx-logger.mjs");function provideLogger(){return(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.importProvidersFrom)(ngx_logger__WEBPACK_IMPORTED_MODULE_1__.f9.forRoot({level:ngx_logger__WEBPACK_IMPORTED_MODULE_1__._z.DEBUG,serverLogLevel:ngx_logger__WEBPACK_IMPORTED_MODULE_1__._z.ERROR}))}},"./packages/angular/mock/translate.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{qX:()=>provideTranslate,zd:()=>zhHansLanguage});var _angular_common_http__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/common/fesm2022/http.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@ngx-translate/core/fesm2020/ngx-translate-core.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/angular/core/i18n/missing-tanslation.ts"),_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/angular/i18n/zhHans.ts");const zhHansLanguage="zh-Hans";class CustomTranslateLoader{getTranslation(lang){return console.log(lang),lang===zhHansLanguage?(0,rxjs__WEBPACK_IMPORTED_MODULE_0__.of)(_i18n__WEBPACK_IMPORTED_MODULE_1__.q):(0,rxjs__WEBPACK_IMPORTED_MODULE_0__.of)(null)}}function provideTranslate(defaultLanguage){return(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.importProvidersFrom)(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__.aw.forRoot({missingTranslationHandler:{provide:_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__.gC,useClass:_core__WEBPACK_IMPORTED_MODULE_4__.l},loader:{provide:_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__.Zw,useClass:CustomTranslateLoader,deps:[_angular_common_http__WEBPACK_IMPORTED_MODULE_5__.eN]},defaultLanguage}))}},"./packages/copilot/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{eV:()=>CopilotChatMessageRoleEnum,yY:()=>CopilotService,lZ:()=>DefaultModel,Py:()=>entryPointsToChatCompletionFunctions,hs:()=>entryPointsToFunctionCallHandler,uF:()=>getCommandPrompt,fe:()=>processChatStream});var asyncToGenerator=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),classPrivateFieldInitSpec=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js"),classPrivateFieldSet=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldSet.js"),classPrivateFieldGet=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet.js"),esm_fetch=__webpack_require__("./node_modules/@microsoft/fetch-event-source/lib/esm/fetch.js"),dist=__webpack_require__("./node_modules/ai/dist/index.mjs"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),switchMap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),throwError=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/throwError.js"),Observable=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Observable.js"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),catchError=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/catchError.js"),dom_fetch=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/dom/fetch.js"),asyncIterator=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncIterator.js"),awaitAsyncGenerator=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/awaitAsyncGenerator.js"),wrapAsyncGenerator=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/wrapAsyncGenerator.js");const textStreamPart={code:"0",name:"text",parse:value=>{if("string"!=typeof value)throw new Error('"text" parts expect a string value.');return{type:"text",value}}},functionCallStreamPart={code:"1",name:"function_call",parse:value=>{if(null==value||"object"!=typeof value||!("function_call"in value)||"object"!=typeof value.function_call||null==value.function_call||!("name"in value.function_call)||!("arguments"in value.function_call)||"string"!=typeof value.function_call.name||"string"!=typeof value.function_call.arguments)throw new Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value}}},dataStreamPart={code:"2",name:"data",parse:value=>{if(!Array.isArray(value))throw new Error('"data" parts expect an array value.');return{type:"data",value}}},errorStreamPart={code:"3",name:"error",parse:value=>{if("string"!=typeof value)throw new Error('"error" parts expect a string value.');return{type:"error",value}}},assistantMessageStreamPart={code:"4",name:"assistant_message",parse:value=>{if(!(null!=value&&"object"==typeof value&&"id"in value&&"role"in value&&"content"in value&&"string"==typeof value.id&&"string"==typeof value.role&&"assistant"===value.role&&Array.isArray(value.content)&&value.content.every((item=>null!=item&&"object"==typeof item&&"type"in item&&"text"===item.type&&"text"in item&&null!=item.text&&"object"==typeof item.text&&"value"in item.text&&"string"==typeof item.text.value))))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value}}},assistantControlDataStreamPart={code:"5",name:"assistant_control_data",parse:value=>{if(null==value||"object"!=typeof value||!("threadId"in value)||!("messageId"in value)||"string"!=typeof value.threadId||"string"!=typeof value.messageId)throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:value.threadId,messageId:value.messageId}}}},dataMessageStreamPart={code:"6",name:"data_message",parse:value=>{if(null==value||"object"!=typeof value||!("role"in value)||!("data"in value)||"string"!=typeof value.role||"data"!==value.role)throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value}}},toolCallStreamPart={code:"7",name:"tool_calls",parse:value=>{if(null==value||"object"!=typeof value||!("tool_calls"in value)||"object"!=typeof value.tool_calls||null==value.tool_calls||!Array.isArray(value.tool_calls)||value.tool_calls.some((tc=>{null!=tc&&"object"==typeof tc&&"id"in tc&&"string"==typeof tc.id&&"type"in tc&&"string"==typeof tc.type&&"function"in tc&&null!=tc.function&&"object"==typeof tc.function&&"arguments"in tc.function&&"string"==typeof tc.function.name&&tc.function.arguments})))throw new Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value}}},streamParts=[textStreamPart,functionCallStreamPart,dataStreamPart,errorStreamPart,assistantMessageStreamPart,assistantControlDataStreamPart,dataMessageStreamPart,toolCallStreamPart],streamPartsByCode={[textStreamPart.code]:textStreamPart,[functionCallStreamPart.code]:functionCallStreamPart,[dataStreamPart.code]:dataStreamPart,[errorStreamPart.code]:errorStreamPart,[assistantMessageStreamPart.code]:assistantMessageStreamPart,[assistantControlDataStreamPart.code]:assistantControlDataStreamPart,[dataMessageStreamPart.code]:dataMessageStreamPart,[toolCallStreamPart.code]:toolCallStreamPart},validCodes=streamParts.map((part=>part.code)),parseStreamPart=line=>{const firstSeparatorIndex=line.indexOf(":");if(-1===firstSeparatorIndex)throw new Error("Failed to parse stream string. No separator found.");const prefix=line.slice(0,firstSeparatorIndex);if(!validCodes.includes(prefix))throw new Error(`Failed to parse stream string. Invalid code ${prefix}.`);const code=prefix,textValue=line.slice(firstSeparatorIndex+1),jsonValue=JSON.parse(textValue);return streamPartsByCode[code].parse(jsonValue)};const NEWLINE="\n".charCodeAt(0);function concatChunks(chunks,totalLength){const concatenatedChunks=new Uint8Array(totalLength);let offset=0;for(const chunk of chunks)concatenatedChunks.set(chunk,offset),offset+=chunk.length;return chunks.length=0,concatenatedChunks}function _readDataStream(){return _readDataStream=(0,wrapAsyncGenerator.Z)((function*(reader,{isAborted}={}){const decoder=new TextDecoder,chunks=[];let totalLength=0;for(;;){const{value}=yield(0,awaitAsyncGenerator.Z)(reader.read());if(value&&(chunks.push(value),totalLength+=value.length,value[value.length-1]!==NEWLINE))continue;if(0===chunks.length)break;const concatenatedChunks=concatChunks(chunks,totalLength);totalLength=0;const streamParts=decoder.decode(concatenatedChunks,{stream:!0}).split("\n").filter((line=>""!==line)).map(parseStreamPart);for(const streamPart of streamParts)yield streamPart;if(isAborted?.()){reader.cancel();break}}})),_readDataStream.apply(this,arguments)}function _parseComplexResponse(){return _parseComplexResponse=(0,asyncToGenerator.Z)((function*({reader,abortControllerRef,update,onFinish,generateId=dist.x0,getCurrentDate=()=>new Date}){const createdAt=getCurrentDate(),prefixMap={data:[]};var _iteratorError,_iteratorAbruptCompletion=!1,_didIteratorError=!1;try{for(var _step,_iterator=(0,asyncIterator.Z)(function readDataStream(_x){return _readDataStream.apply(this,arguments)}(reader,{isAborted:()=>null===abortControllerRef?.current}));_iteratorAbruptCompletion=!(_step=yield _iterator.next()).done;_iteratorAbruptCompletion=!1){const{type,value}=_step.value;{"text"===type&&(prefixMap.text?prefixMap.text={...prefixMap.text,content:(prefixMap.text.content||"")+value}:prefixMap.text={id:generateId(),role:"assistant",content:value,createdAt});let functionCallMessage=null;"function_call"===type&&(prefixMap.function_call={id:generateId(),role:"assistant",content:"",function_call:value.function_call,name:value.function_call.name,createdAt},functionCallMessage=prefixMap.function_call);let toolCallMessage=null;"tool_calls"===type&&(prefixMap.tool_calls={id:generateId(),role:"assistant",content:"",tool_calls:value.tool_calls,createdAt},toolCallMessage=prefixMap.tool_calls),"data"===type&&prefixMap.data.push(...value);const responseMessage=prefixMap.text;update([functionCallMessage,toolCallMessage,responseMessage].filter(Boolean),[...prefixMap.data])}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorAbruptCompletion&&null!=_iterator.return&&(yield _iterator.return())}finally{if(_didIteratorError)throw _iteratorError}}return onFinish?.(prefixMap),{messages:[prefixMap.text,prefixMap.function_call,prefixMap.tool_calls].filter(Boolean),data:prefixMap.data}})),_parseComplexResponse.apply(this,arguments)}function _callChatApi(){return _callChatApi=(0,asyncToGenerator.Z)((function*({api,messages,body,credentials,headers,abortController,appendMessage,restoreMessagesOnFailure,onResponse,onUpdate,onFinish,generateId}){const response=yield fetch(api,{method:"POST",body:JSON.stringify({messages,...body}),headers:{"Content-Type":"application/json",...headers},signal:abortController?.()?.signal,credentials}).catch((err=>{throw restoreMessagesOnFailure(),err}));if(onResponse)try{yield onResponse(response)}catch(err){throw err}if(!response.ok)throw restoreMessagesOnFailure(),new Error((yield response.text())||"Failed to fetch the chat response.");if(!response.body)throw new Error("The response body is empty.");const reader=(0,dist.HP)(response).getReader();if("true"===response.headers.get(dist.uY))return yield function parseComplexResponse(_x){return _parseComplexResponse.apply(this,arguments)}({reader,abortControllerRef:null!=abortController?{current:abortController()}:void 0,update:onUpdate,onFinish(prefixMap){onFinish&&null!=prefixMap.text&&onFinish(prefixMap.text)},generateId});{const createdAt=new Date,decode=(0,dist.NX)(!1);let streamedResponse="";const responseMessage={id:generateId(),createdAt,content:"",role:"assistant"};for(;;){const{done,value}=yield reader.read();if(done)break;if(streamedResponse+=decode(value),streamedResponse.startsWith('{"function_call":')?responseMessage.function_call=streamedResponse:streamedResponse.startsWith('{"tool_calls":')?responseMessage.tool_calls=streamedResponse:responseMessage.content=streamedResponse,appendMessage({...responseMessage}),null===abortController?.()){reader.cancel();break}}if(streamedResponse.startsWith('{"function_call":')){const parsedFunctionCall=JSON.parse(streamedResponse).function_call;responseMessage.function_call=parsedFunctionCall,appendMessage({...responseMessage})}if(streamedResponse.startsWith('{"tool_calls":')){const parsedToolCalls=JSON.parse(streamedResponse).tool_calls;responseMessage.tool_calls=parsedToolCalls,appendMessage({...responseMessage})}return onFinish&&onFinish(responseMessage),responseMessage}})),_callChatApi.apply(this,arguments)}__webpack_require__("./node_modules/json5/dist/index.js");const DefaultModel="gpt-3.5-turbo";var CopilotChatMessageRoleEnum;!function(CopilotChatMessageRoleEnum){CopilotChatMessageRoleEnum.System="system",CopilotChatMessageRoleEnum.User="user",CopilotChatMessageRoleEnum.Assistant="assistant",CopilotChatMessageRoleEnum.Info="info"}(CopilotChatMessageRoleEnum||(CopilotChatMessageRoleEnum={}));const AI_PROVIDERS={openai:{apiHost:"https://api.openai.com",chatCompletionsUrl:"/v1/chat/completions",modelsUrl:"/v1/models"},azure:{apiHost:"",chatCompletionsUrl:"/v1/chat/completions",modelsUrl:"/v1/models"}};function getCommandPrompt(prompt){const match=prompt.match(/\/([a-zA-Z\-]*)\s*/i),command=match?.[1];return{command,prompt:prompt.replace(`/${command}`,"").trim()}}function chatCompletionsUrl(copilot){const apiHost=copilot.apiHost||AI_PROVIDERS[copilot.provider]?.apiHost,chatCompletionsUrl=AI_PROVIDERS[copilot.provider]?.chatCompletionsUrl;return copilot.chatUrl||(apiHost?.endsWith("/")?apiHost.slice(0,apiHost.length-1)+chatCompletionsUrl:apiHost+chatCompletionsUrl)}var _copilot$=new WeakMap;class CopilotService{get copilot(){return(0,classPrivateFieldGet.Z)(this,_copilot$).value}set copilot(value){(0,classPrivateFieldGet.Z)(this,_copilot$).next({...(0,classPrivateFieldGet.Z)(this,_copilot$).value,...value??{}})}get enabled(){return this.copilot?.enabled&&this.copilot?.apiKey}get hasKey(){return!!this.copilot?.apiKey}constructor(copilot){(0,classPrivateFieldInitSpec.Z)(this,_copilot$,{writable:!0,value:void 0}),(0,classPrivateFieldSet.Z)(this,_copilot$,new BehaviorSubject.X({})),this.copilot$=(0,classPrivateFieldGet.Z)(this,_copilot$).asObservable(),copilot&&(this.copilot=copilot)}requestOptions(){return{}}createChat(messages,options){var _this=this;return(0,asyncToGenerator.Z)((function*(){const{request,signal}=options??{},response=yield fetch(chatCompletionsUrl(_this.copilot),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_this.copilot.apiKey}`},signal,body:JSON.stringify({model:DefaultModel,messages,...request??{}})});if(200===response.status){return(yield response.json()).choices}throw new Error((yield response.json()).error?.message)}))()}chatCompletions(messages,request){return(0,dom_fetch.U)(chatCompletionsUrl(this.copilot),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.copilot.apiKey}`},body:JSON.stringify({model:DefaultModel,messages,...request??{}})}).pipe((0,switchMap.w)((response=>response.ok?response.json():(0,throwError._)((()=>`Error ${response.status}`)))))}chatStream(messages,request){return new Observable.y((subscriber=>{const ctrl=new AbortController;return(0,esm_fetch.L)(chatCompletionsUrl(this.copilot),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.copilot.apiKey}`},body:JSON.stringify({model:DefaultModel,messages,...request??{},stream:!0}),signal:ctrl.signal,onopen:response=>(0,asyncToGenerator.Z)((function*(){response.ok&&response.headers.get("content-type")===esm_fetch.a||(response.status>=400&&response.status<500&&response.status,subscriber.error(response.status))}))(),onmessage(msg){if("FatalError"===msg.event)throw new Error(msg.data);if('"[DONE]"'===msg.data||"[DONE]"===msg.data)subscriber.complete();else try{subscriber.next(JSON.parse(msg.data))}catch(err){subscriber.error(err)}},onclose(){subscriber.complete()},onerror(err){subscriber.error(err),ctrl.abort()}}),()=>ctrl.abort()}))}getModels(){return(0,dom_fetch.U)(function modelsUrl(copilot){const apiHost=copilot.apiHost||AI_PROVIDERS[copilot.provider]?.apiHost,modelsUrl=AI_PROVIDERS[copilot.provider]?.modelsUrl;return copilot.modelsUrl||(apiHost?.endsWith("/")?apiHost.slice(0,apiHost.length-1)+modelsUrl:apiHost+modelsUrl)}(this.copilot),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.copilot.apiKey}`}}).pipe((0,switchMap.w)((response=>response.ok?response.json():(0,of.of)({error:!0,message:`Error ${response.status}`}))),(0,catchError.K)((err=>(console.error(err),(0,of.of)({error:!0,message:err.message})))))}chat({sendExtraMessageFields,onResponse,onFinish,onError,credentials,headers,body,generateId=dist.x0}={},chatRequest,{options,data}={},{abortController}){var _this2=this;return(0,asyncToGenerator.Z)((function*(){return yield function callChatApi(_x){return _callChatApi.apply(this,arguments)}({api:chatCompletionsUrl(_this2.copilot),messages:sendExtraMessageFields?chatRequest.messages:chatRequest.messages.map((({role,content,name,function_call})=>({role,content,...void 0!==name&&{name},...void 0!==function_call&&{function_call}}))),body:{data:chatRequest.data,...body,...options?.body,stream:!0},headers:{..._this2.requestOptions()?.headers??{},...headers,...options?.headers},abortController:()=>abortController,credentials,onResponse,onUpdate(merged,data){console.log("onUpdate",merged,data)},onFinish,appendMessage(message){},restoreMessagesOnFailure(){},generateId})}))()}}new BehaviorSubject.X({});function processChatStream(_x){return _processChatStream.apply(this,arguments)}function _processChatStream(){return(_processChatStream=(0,asyncToGenerator.Z)((function*({getStreamedResponse,experimental_onFunctionCall,experimental_onToolCall,updateChatRequest,getCurrentMessages}){for(;;){const messagesAndDataOrJustMessage=yield getStreamedResponse();if("messages"in messagesAndDataOrJustMessage){let hasFollowingResponse=!1;for(const message of messagesAndDataOrJustMessage.messages)if(void 0!==message.function_call&&"string"!=typeof message.function_call||void 0!==message.tool_calls&&"string"!=typeof message.tool_calls){if(hasFollowingResponse=!0,experimental_onFunctionCall){const functionCall=message.function_call;if("object"!=typeof functionCall){console.warn("experimental_onFunctionCall should not be defined when using tools");continue}const functionCallResponse=yield experimental_onFunctionCall(getCurrentMessages(),functionCall);if(void 0===functionCallResponse){hasFollowingResponse=!1;break}functionCallResponse&&updateChatRequest(functionCallResponse)}if(experimental_onToolCall){const toolCalls=message.tool_calls;if(!Array.isArray(toolCalls)||toolCalls.some((toolCall=>"object"!=typeof toolCall))){console.warn("experimental_onToolCall should not be defined when using tools");continue}const toolCallResponse=yield experimental_onToolCall(getCurrentMessages(),toolCalls);if(void 0===toolCallResponse){hasFollowingResponse=!1;break}toolCallResponse&&updateChatRequest(toolCallResponse)}}if(!hasFollowingResponse)break}else{const streamedResponseMessage=messagesAndDataOrJustMessage;if(!(void 0!==streamedResponseMessage.function_call&&"string"!=typeof streamedResponseMessage.function_call||void 0!==streamedResponseMessage.tool_calls&&"string"!=typeof streamedResponseMessage.tool_calls))break;if(experimental_onFunctionCall){const functionCall=streamedResponseMessage.function_call;if("object"!=typeof functionCall){console.warn("experimental_onFunctionCall should not be defined when using tools");continue}const functionCallResponse=yield experimental_onFunctionCall(getCurrentMessages(),functionCall);if(updateChatRequest({messages:[{...streamedResponseMessage,content:`✅ Function '${functionCall.name}' call successful!`}]}),void 0===functionCallResponse)break;functionCallResponse&&(fixFunctionCallArguments(functionCallResponse),updateChatRequest(functionCallResponse))}if(experimental_onToolCall){const toolCalls=streamedResponseMessage.tool_calls;if("object"!=typeof toolCalls){console.warn("experimental_onToolCall should not be defined when using functions");continue}const toolCallResponse=yield experimental_onToolCall(getCurrentMessages(),toolCalls);if(void 0===toolCallResponse)break;toolCallResponse&&(fixFunctionCallArguments(toolCallResponse),updateChatRequest(toolCallResponse))}function fixFunctionCallArguments(response){for(const message of response.messages){if(void 0!==message.tool_calls)for(const toolCall of message.tool_calls)"object"==typeof toolCall&&toolCall.function.arguments&&"string"!=typeof toolCall.function.arguments&&(toolCall.function.arguments=JSON.stringify(toolCall.function.arguments));void 0!==message.function_call&&"object"==typeof message.function_call&&message.function_call.arguments&&"string"!=typeof message.function_call.arguments&&(message.function_call.arguments=JSON.stringify(message.function_call.arguments))}}}}}))).apply(this,arguments)}function entryPointsToFunctionCallHandler(entryPoints){return function(){var _ref=(0,asyncToGenerator.Z)((function*(chatMessages,functionCall){const entrypointsByFunctionName={};for(const entryPoint of entryPoints)entrypointsByFunctionName[entryPoint.name]=entryPoint;const entryPointFunction=entrypointsByFunctionName[functionCall.name||""];if(entryPointFunction){let parsedFunctionCallArguments=[];functionCall.arguments&&(parsedFunctionCallArguments=JSON.parse(functionCall.arguments));const paramsInCorrectOrder=[];for(let arg of entryPointFunction.argumentAnnotations)paramsInCorrectOrder.push(parsedFunctionCallArguments[arg.name]);return yield entryPointFunction.implementation(...paramsInCorrectOrder)}}));return function(_x,_x2){return _ref.apply(this,arguments)}}()}function entryPointsToChatCompletionFunctions(entryPoints){return entryPoints.map(annotatedFunctionToChatCompletionFunction)}function annotatedFunctionToChatCompletionFunction(annotatedFunction){const parameters={};for(const arg of annotatedFunction.argumentAnnotations){const{name,required,...forwardedArgs}=arg;parameters[arg.name]=forwardedArgs}const requiredParameterNames=[];for(const arg of annotatedFunction.argumentAnnotations)arg.required&&requiredParameterNames.push(arg.name);return{name:annotatedFunction.name,description:annotatedFunction.description,parameters:{type:"object",properties:parameters,required:requiredParameterNames}}}},"./packages/angular/copilot/token/token.component.ts.css?ngResource!=!./node_modules/@angular-devkit/build-angular/node_modules/@ngtools/webpack/src/loaders/inline-resource.js?data=CiAgICAgIDpob3N0IHsKICAgICAgfQogICAg!./packages/angular/copilot/token/token.component.ts":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"\n      :host {\n      }\n    ",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/common/search/search.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  position: relative;\n  display: block;\n}\n:host .ngm-search__icon {\n  position: absolute;\n  left: 10px;\n  top: 0px;\n  bottom: 0px;\n  display: flex;\n  align-items: center;\n}\n\n.ngm-search__input {\n  width: 100%;\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/common/table/table/table.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  display: flex;\n  flex-direction: column;\n}\n\n.searchable .mat-mdc-input-element {\n  background-color: transparent;\n}\n\n.mat-mdc-cell, .mat-mdc-header-cell {\n  white-space: nowrap;\n}\n.mat-mdc-cell.number, .mat-mdc-header-cell.number {\n  text-align: right;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/copilot/chat/chat.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  background-color: var(--ngm-copilot-bg-color, #fff);\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}\n\n.copilot-code-container {\n  border-radius: 0.5rem;\n  --tw-bg-opacity: 1;\n  background-color: rgb(229 231 235 / var(--tw-bg-opacity));\n  font-size: 0.75rem;\n  line-height: 1rem;\n  --tw-text-opacity: 1;\n  color: rgb(107 114 128 / var(--tw-text-opacity));\n}\n\n.copilot-code-titlebar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom-width: 2px;\n  padding: 0.5rem;\n}\n\n.copilot-code-copy-button {\n  display: flex;\n  align-items: center;\n}\n\n.copilot-code-content {\n  overflow-x: auto;\n  overflow-y: hidden;\n  white-space: pre;\n  padding: 0.5rem;\n}\n\n.copilot-message-stop .emoji-loader {\n  width: 1.5rem;\n}\n.copilot-message-stop .emoji-loader::before {\n  font-size: 1rem;\n  line-height: 1rem;\n}\n\n.ngm-copilot__message-remove.mat-mdc-icon-button {\n  background-color: var(--ngm-copilot-bg-color, #fff);\n  position: absolute;\n  z-index: 101;\n  --tw-text-opacity: 1;\n  color: rgb(100 116 139 / var(--tw-text-opacity));\n}\n\n.ngm-copilot__message-remove.mat-mdc-icon-button:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(248 250 252 / var(--tw-bg-opacity));\n  --tw-text-opacity: 1;\n  color: rgb(239 68 68 / var(--tw-text-opacity));\n}\n\n.pac-colpilot__clear-messages {\n  border-style: dashed;\n}\n\n.ngm-copilot__resubmit {\n  margin-top: 0.5rem;\n  margin-bottom: 0.5rem;\n  border-radius: 9999px;\n}\n\n.mat-mdc-input-element {\n  background-color: transparent;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\n\n.ngm-colpilot__active {\n  --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n\n:is(.dark .ngm-colpilot__active) {\n  --tw-shadow-color: #262626;\n  --tw-shadow: var(--tw-shadow-colored);\n}\n\n.ngm-copilot-chat__message-content {\n  max-width: 100%;\n  overflow: auto;\n  border-radius: 0.5rem;\n  background-color: rgb(245 245 245 / 0.5);\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n  padding-left: 1rem;\n  padding-right: 1rem;\n}\n\n:is(.dark .ngm-copilot-chat__message-content) {\n  background-color: rgb(245 245 245 / 0.1);\n}\n\n.ngm-copilot__user-message {\n  background-color: rgb(243 244 246 / 0.5);\n}\n\n:is(.dark .ngm-copilot__user-message) {\n  --tw-bg-opacity: 1;\n  background-color: rgb(64 64 64 / var(--tw-bg-opacity));\n}\n\n.ngm-copilot-chat__answering {\n  background-color: var(--ngm-copilot-bg-color);\n}\n\n:host::ng-deep markdown p:first-child {\n  text-indent: 1rem;\n}\n:host::ng-deep .ngxp__container.ngxp__animation {\n  border-width: 0px;\n  padding: 0px;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n\n::ng-deep .ngm-copilot-chat__autocomplete-panel.ngm-density__compact .mdc-list-item {\n  padding-left: 0.5rem;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./packages/angular/copilot/enable/enable.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    display: flex;\n    height: 100%;\n    width: 100%\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);